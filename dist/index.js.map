{"version":3,"file":"index.js","sources":["../src/utils/editorsUtils.js","../src/i18n/locales/en.js","../src/i18n/locales/de.js","../src/i18n/translations.js","../src/LinkTooltip.jsx","../src/CustomSelect.jsx","../src/ColorPicker.jsx","../src/Toolbar.jsx","../src/RichtextEditor.jsx"],"sourcesContent":["/**\n * Utility functions for rich text editor operations\n * Provides formatting, selection, and content manipulation functions\n */\n\n/**\n * Apply formatting to the selected text\n * @param {string} command - The formatting command\n * @param {string} value - Optional value for the command\n */\nexport const applyFormatting = (command, value = null) => {\n  // Special handling for formatBlock inside lists\n  if (command === \"formatBlock\") {\n    const handled = applyBlockFormatInList(value);\n    if (handled) {\n      cleanupInlineFontStyles();\n      return;\n    }\n  }\n\n  document.execCommand(command, false, value);\n\n  // When changing block format, clean up inline font-size styles\n  if (command === \"formatBlock\") {\n    cleanupInlineFontStyles();\n  }\n};\n\n/**\n * Apply block format (heading/paragraph) to content inside a list\n * Returns true if handled, false if not inside a list\n * @param {string} format - The format to apply (h1, h2, h3, p)\n * @returns {boolean} Whether the format was applied\n */\nconst applyBlockFormatInList = (format) => {\n  const selection = window.getSelection();\n  if (!selection || selection.rangeCount === 0) return false;\n\n  // Find if we're inside a list item\n  let node = selection.anchorNode;\n  if (node.nodeType === Node.TEXT_NODE) {\n    node = node.parentElement;\n  }\n\n  let listItem = null;\n  let current = node;\n  while (current) {\n    if (current.tagName === \"LI\") {\n      listItem = current;\n      break;\n    }\n    if (current.contentEditable === \"true\") {\n      break;\n    }\n    current = current.parentElement;\n  }\n\n  if (!listItem) return false; // Not inside a list, let normal formatBlock handle it\n\n  // Get the format tag (remove < > if present)\n  const tag = format.replace(/[<>]/g, \"\").toLowerCase();\n\n  if (tag === \"p\") {\n    // Converting to paragraph - remove any heading wrappers inside the list item\n    const headings = listItem.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\n    headings.forEach((heading) => {\n      // Replace heading with its content\n      while (heading.firstChild) {\n        heading.parentNode.insertBefore(heading.firstChild, heading);\n      }\n      heading.remove();\n    });\n  } else if ([\"h1\", \"h2\", \"h3\"].includes(tag)) {\n    // Applying heading - wrap the list item content\n    // First, remove any existing headings\n    const existingHeadings = listItem.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\n    existingHeadings.forEach((heading) => {\n      while (heading.firstChild) {\n        heading.parentNode.insertBefore(heading.firstChild, heading);\n      }\n      heading.remove();\n    });\n\n    // Create new heading and move all content into it\n    const heading = document.createElement(tag);\n    while (listItem.firstChild) {\n      heading.appendChild(listItem.firstChild);\n    }\n    listItem.appendChild(heading);\n  }\n\n  return true;\n};\n\n/**\n * Remove inline font-size styles from selected content\n * This is needed when changing from heading to paragraph to reset the text size\n */\nconst cleanupInlineFontStyles = () => {\n  const selection = window.getSelection();\n  if (!selection || selection.rangeCount === 0) return;\n\n  // Get the common ancestor of the selection\n  const range = selection.getRangeAt(0);\n  let container = range.commonAncestorContainer;\n\n  // If it's a text node, get the parent element\n  if (container.nodeType === Node.TEXT_NODE) {\n    container = container.parentElement;\n  }\n\n  // Find the block element that was just formatted\n  let blockElement = container;\n  while (blockElement && ![\"H1\", \"H2\", \"H3\", \"P\", \"BLOCKQUOTE\", \"LI\"].includes(blockElement.tagName)) {\n    blockElement = blockElement.parentElement;\n  }\n\n  if (!blockElement) return;\n\n  // Remove font-size from all elements within the block\n  const elementsWithFontSize = blockElement.querySelectorAll(\"[style]\");\n  elementsWithFontSize.forEach((el) => {\n    el.style.removeProperty(\"font-size\");\n    // If style attribute is now empty, remove it entirely\n    if (!el.getAttribute(\"style\")?.trim()) {\n      el.removeAttribute(\"style\");\n    }\n  });\n\n  // Also check the block element itself\n  if (blockElement.style) {\n    blockElement.style.removeProperty(\"font-size\");\n    if (!blockElement.getAttribute(\"style\")?.trim()) {\n      blockElement.removeAttribute(\"style\");\n    }\n  }\n};\n\n/**\n * Clean up malformed HTML in the editor\n * Removes empty heading/paragraph tags and fixes common nesting issues\n * @param {HTMLElement} editorElement - The contenteditable editor element\n */\nexport const cleanupEditorHTML = (editorElement) => {\n  if (!editorElement) return;\n\n  // Remove empty heading and paragraph tags (but keep <p><br></p> as they're line breaks)\n  const emptyTags = editorElement.querySelectorAll(\"h1:empty, h2:empty, h3:empty, h4:empty, h5:empty, h6:empty\");\n  emptyTags.forEach((el) => el.remove());\n\n  // Remove headings that only contain empty paragraphs\n  const headings = editorElement.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\n  headings.forEach((heading) => {\n    // Check if heading only contains empty elements or whitespace\n    const hasContent = Array.from(heading.childNodes).some((child) => {\n      if (child.nodeType === Node.TEXT_NODE) {\n        return child.textContent.trim().length > 0;\n      }\n      if (child.nodeType === Node.ELEMENT_NODE) {\n        // Check if it's a list or has actual content\n        if ([\"OL\", \"UL\", \"LI\"].includes(child.tagName)) return true;\n        return child.textContent.trim().length > 0;\n      }\n      return false;\n    });\n\n    if (!hasContent) {\n      heading.remove();\n    }\n  });\n\n  // Fix lists that are wrapped in headings - unwrap them\n  const listsInHeadings = editorElement.querySelectorAll(\"h1 > ol, h1 > ul, h2 > ol, h2 > ul, h3 > ol, h3 > ul\");\n  listsInHeadings.forEach((list) => {\n    const heading = list.parentElement;\n    if (heading && [\"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\"].includes(heading.tagName)) {\n      // Move the list outside of the heading\n      heading.parentNode.insertBefore(list, heading.nextSibling);\n      // Remove the heading if it's now empty\n      if (!heading.textContent.trim()) {\n        heading.remove();\n      }\n    }\n  });\n};\n\n/**\n * Get information about the current selection\n * @returns {object|null} Selection information or null if no selection\n */\nexport const getSelectionInfo = () => {\n  const selection = window.getSelection();\n  if (!selection || selection.rangeCount === 0) {\n    return null;\n  }\n\n  const range = selection.getRangeAt(0);\n  return {\n    selection,\n    range: range.cloneRange(),\n    text: selection.toString(),\n    isCollapsed: selection.isCollapsed,\n  };\n};\n\n/**\n * Insert a link at the specified range or current selection\n * @param {string} url - The URL to insert\n * @param {Range} range - Optional range to insert at\n */\nexport const insertLink = (url, range = null) => {\n  const selection = window.getSelection();\n\n  if (range) {\n    // Restore the stored range\n    selection.removeAllRanges();\n    selection.addRange(range);\n  }\n\n  if (selection.isCollapsed) {\n    // No text selected, insert the URL as both text and link\n    const linkElement = document.createElement(\"a\");\n    linkElement.href = url;\n    linkElement.textContent = url;\n    linkElement.target = \"_blank\";\n    linkElement.rel = \"noopener noreferrer\";\n\n    range.insertNode(linkElement);\n    range.setStartAfter(linkElement);\n    range.setEndAfter(linkElement);\n    selection.removeAllRanges();\n    selection.addRange(range);\n  } else {\n    // Text is selected, convert it to a link\n    document.execCommand(\"createLink\", false, url);\n\n    // Set target and rel attributes for the created link\n    const links = document.querySelectorAll('a[href=\"' + url + '\"]');\n    links.forEach((link) => {\n      link.target = \"_blank\";\n      link.rel = \"noopener noreferrer\";\n    });\n  }\n};\n\n/**\n * Remove link formatting from the current selection\n */\nexport const removeLink = () => {\n  document.execCommand(\"unlink\");\n};\n\n/**\n * Check if the current selection has specific formatting\n * @param {string} command - The formatting command to check\n * @returns {boolean} Whether the formatting is active\n */\nexport const isFormatActive = (command) => {\n  return document.queryCommandState(command);\n};\n\n/**\n * Get the current format block type\n * @returns {string} The current block format (h1, h2, h3, p, blockquote)\n */\nexport const getCurrentBlockFormat = () => {\n  const sel = window.getSelection();\n  if (!sel?.anchorNode) return \"p\";\n\n  // Start from the anchor node and walk up to find block-level elements\n  let node =\n    sel.anchorNode.nodeType === Node.ELEMENT_NODE\n      ? sel.anchorNode\n      : sel.anchorNode.parentElement;\n\n  while (node) {\n    const tag = node.tagName?.toUpperCase();\n\n    // Check for heading or paragraph tags - return immediately when found\n    // This works for content inside list items too (headings may wrap lists)\n    if ([\"H1\", \"H2\", \"H3\", \"P\", \"BLOCKQUOTE\"].includes(tag)) {\n      return tag.toLowerCase();\n    }\n\n    // Stop at contenteditable boundary\n    if (node.contentEditable === \"true\") {\n      break;\n    }\n\n    node = node.parentElement;\n  }\n\n  return \"p\";\n};\n\n/**\n * Insert an image at the current cursor position\n * @param {string} src - The image source (URL or base64 data)\n * @param {object} options - Optional image attributes\n */\nexport const insertImage = (src, options = {}) => {\n  const { alt = \"\", width = \"auto\", maxWidth = \"100%\" } = options;\n\n  const img = document.createElement(\"img\");\n  img.src = src;\n  img.alt = alt;\n  img.style.maxWidth = maxWidth;\n  img.style.height = \"auto\";\n  if (width !== \"auto\") {\n    img.style.width = width;\n  }\n\n  const selection = window.getSelection();\n  if (selection && selection.rangeCount > 0) {\n    const range = selection.getRangeAt(0);\n    range.deleteContents();\n    range.insertNode(img);\n\n    // Move cursor after the image\n    range.setStartAfter(img);\n    range.setEndAfter(img);\n    selection.removeAllRanges();\n    selection.addRange(range);\n  }\n};\n\n/**\n * Insert HTML at the current cursor position\n * @param {string} html - The HTML to insert\n */\nexport const insertHTML = (html) => {\n  const selection = window.getSelection();\n  if (selection.rangeCount > 0) {\n    const range = selection.getRangeAt(0);\n    range.deleteContents();\n\n    const div = document.createElement(\"div\");\n    div.innerHTML = html;\n    const fragment = document.createDocumentFragment();\n\n    while (div.firstChild) {\n      fragment.appendChild(div.firstChild);\n    }\n\n    range.insertNode(fragment);\n    range.collapse(false);\n    selection.removeAllRanges();\n    selection.addRange(range);\n  }\n};\n\n/**\n * Get the plain text content from HTML and count characters\n * @param {string} rawText - The HTML content\n * @returns {number} Character count of plain text content\n */\nexport const countContentRealLength = (rawText) => {\n  if (!rawText) return 0;\n\n  // Remove HTML tags using a regular expression\n  const textContent = rawText.replace(/<\\/?[^>]+(>|$)/g, \"\");\n\n  // Count the length of the cleaned content\n  const characterCount = textContent.length;\n\n  return characterCount;\n};\n\n/**\n * Clean up HTML content by removing unnecessary tags and attributes\n * @param {string} html - The HTML to clean\n * @returns {string} Cleaned HTML\n */\nexport const cleanHTML = (html) => {\n  if (!html) return \"\";\n\n  // Create a temporary div to parse the HTML\n  const div = document.createElement(\"div\");\n  div.innerHTML = html;\n\n  // Remove empty paragraphs and divs\n  const emptyElements = div.querySelectorAll(\"p:empty, div:empty\");\n  emptyElements.forEach((el) => el.remove());\n\n  // Remove style attributes (keep only semantic formatting)\n  const elementsWithStyle = div.querySelectorAll(\"[style]\");\n  elementsWithStyle.forEach((el) => el.removeAttribute(\"style\"));\n\n  return div.innerHTML;\n};\n","/**\n * English (US) translations for the Rich Text Editor\n */\nexport const enUS = {\n  // Toolbar tooltips\n  toolbar: {\n    undo: \"Undo (Ctrl/Cmd+Z)\",\n    redo: \"Redo (Ctrl+Y / Cmd+Shift+Z)\",\n    bold: \"Bold (Ctrl+B)\",\n    italic: \"Italic (Ctrl+I)\",\n    underline: \"Underline (Ctrl+U)\",\n    strikethrough: \"Strikethrough (Ctrl+S)\",\n    link: \"Insert Link (Ctrl+K)\",\n    clearFormat: \"Remove Formatting (Ctrl+E)\",\n    bulletList: \"Bullet List\",\n    numberedList: \"Numbered List\",\n    outdent: \"Decrease Indent\",\n    indent: \"Increase Indent\",\n    alignLeft: \"Align Left\",\n    alignCenter: \"Align Center\",\n    alignRight: \"Align Right\",\n    alignJustify: \"Justify\",\n    image: \"Insert Image\",\n    textColor: \"Text Color\",\n    search: \"Search\",\n    help: \"Help\",\n  },\n\n  // Heading options\n  headings: {\n    h1: \"Heading 1\",\n    h2: \"Heading 2\",\n    h3: \"Heading 3\",\n    h4: \"Heading 4\",\n    h5: \"Heading 5\",\n    h6: \"Heading 6\",\n    p: \"Paragraph\",\n  },\n\n  // Link tooltip\n  linkTooltip: {\n    insertTitle: \"Insert Link\",\n    editTitle: \"Edit Link\",\n    placeholder: \"Enter URL (e.g., https://example.com)\",\n    insert: \"Insert\",\n    update: \"Update\",\n    cancel: \"Cancel\",\n    remove: \"Remove\",\n  },\n\n  // Editor\n  editor: {\n    placeholder: \"Start typing...\",\n  },\n\n  // Select\n  select: {\n    placeholder: \"Select...\",\n  },\n};\n","/**\n * German (Germany) translations for the Rich Text Editor\n */\nexport const deDE = {\n  // Toolbar tooltips\n  toolbar: {\n    undo: \"Rückgängig (Strg/Cmd+Z)\",\n    redo: \"Wiederholen (Strg+Y / Cmd+Shift+Z)\",\n    bold: \"Fett (Strg+B)\",\n    italic: \"Kursiv (Strg+I)\",\n    underline: \"Unterstrichen (Strg+U)\",\n    strikethrough: \"Durchgestrichen (Strg+S)\",\n    link: \"Link einfügen (Strg+K)\",\n    clearFormat: \"Formatierung entfernen (Strg+E)\",\n    bulletList: \"Aufzählungsliste\",\n    numberedList: \"Nummerierte Liste\",\n    outdent: \"Einzug verringern\",\n    indent: \"Einzug erhöhen\",\n    alignLeft: \"Linksbündig\",\n    alignCenter: \"Zentriert\",\n    alignRight: \"Rechtsbündig\",\n    alignJustify: \"Blocksatz\",\n    image: \"Bild einfügen\",\n    textColor: \"Textfarbe\",\n    search: \"Suchen\",\n    help: \"Hilfe\",\n  },\n\n  // Heading options\n  headings: {\n    h1: \"Überschrift 1\",\n    h2: \"Überschrift 2\",\n    h3: \"Überschrift 3\",\n    h4: \"Überschrift 4\",\n    h5: \"Überschrift 5\",\n    h6: \"Überschrift 6\",\n    p: \"Absatz\",\n  },\n\n  // Link tooltip\n  linkTooltip: {\n    insertTitle: \"Link einfügen\",\n    editTitle: \"Link bearbeiten\",\n    placeholder: \"URL eingeben (z.B. https://example.com)\",\n    insert: \"Einfügen\",\n    update: \"Aktualisieren\",\n    cancel: \"Abbrechen\",\n    remove: \"Entfernen\",\n  },\n\n  // Editor\n  editor: {\n    placeholder: \"Text eingeben...\",\n  },\n\n  // Select\n  select: {\n    placeholder: \"Auswählen...\",\n  },\n};\n","/**\n * i18n translations module for the Rich Text Editor\n * Supports automatic language detection from the document\n */\n\nimport { enUS } from \"./locales/en\";\nimport { deDE } from \"./locales/de\";\n\n/**\n * Available locales mapped by full locale code\n * Also supports short codes (en, de) for compatibility\n */\nexport const locales = {\n  \"en-US\": enUS,\n  \"de-DE\": deDE,\n  // Short code aliases for compatibility with i18next and other configs\n  \"en\": enUS,\n  \"de\": deDE,\n};\n\n/**\n * Supported language codes (both full and short formats)\n */\nexport const supportedLanguages = [\"en-US\", \"de-DE\", \"en\", \"de\"];\n\n/**\n * Default language\n */\nexport const defaultLanguage = \"en-US\";\n\n/**\n * Default translations (English US)\n */\nexport const defaultTranslations = enUS;\n\n/**\n * Normalize a language code to full locale format\n * @param {string} lang - Language code (e.g., \"en\", \"en-US\", \"de\", \"de-DE\")\n * @returns {string|null} Normalized locale code or null if not supported\n */\nconst normalizeLocale = (lang) => {\n  if (!lang) return null;\n\n  // Check for exact match first (e.g., \"en-US\", \"de-DE\")\n  if (supportedLanguages.includes(lang)) {\n    return lang;\n  }\n\n  // Try to match by primary language code (e.g., \"en\" -> \"en-US\", \"de\" -> \"de-DE\")\n  const primaryLang = lang.split(\"-\")[0].toLowerCase();\n  const matchingLocale = supportedLanguages.find(\n    (locale) => locale.split(\"-\")[0].toLowerCase() === primaryLang\n  );\n\n  return matchingLocale || null;\n};\n\n/**\n * Detect the current language from various sources\n * Priority: 1. html lang attribute, 2. navigator.language, 3. default (en-US)\n * @returns {string} Detected language code (e.g., \"en-US\", \"de-DE\")\n */\nexport const detectLanguage = () => {\n  // Check if running in browser\n  if (typeof document === \"undefined\") {\n    return defaultLanguage;\n  }\n\n  // 1. Check html lang attribute (most reliable as it's set by the app)\n  const htmlLang = document.documentElement.lang;\n  if (htmlLang) {\n    const normalized = normalizeLocale(htmlLang);\n    if (normalized) {\n      return normalized;\n    }\n  }\n\n  // 2. Check navigator.language\n  if (typeof navigator !== \"undefined\" && navigator.language) {\n    const normalized = normalizeLocale(navigator.language);\n    if (normalized) {\n      return normalized;\n    }\n  }\n\n  // 3. Default to English (US)\n  return defaultLanguage;\n};\n\n/**\n * Get translations for a specific language\n * @param {string} lang - Language code (e.g., \"en\", \"en-US\", \"de\", \"de-DE\")\n * @returns {Object} Translations object\n */\nexport const getTranslations = (lang) => {\n  // Direct lookup first (supports both \"en\" and \"en-US\" formats)\n  if (lang && locales[lang]) {\n    return locales[lang];\n  }\n  // Fallback to normalized locale\n  const normalizedLocale = normalizeLocale(lang) || defaultLanguage;\n  return locales[normalizedLocale] || locales[defaultLanguage];\n};\n\n/**\n * Get translations based on auto-detected language\n * @returns {Object} Translations object for detected language\n */\nexport const getAutoTranslations = () => {\n  const detectedLang = detectLanguage();\n  return getTranslations(detectedLang);\n};\n\n/**\n * Deep merge two objects\n * @param {Object} target - Target object\n * @param {Object} source - Source object to merge\n * @returns {Object} Merged object\n */\nconst deepMerge = (target, source) => {\n  const result = { ...target };\n\n  for (const key in source) {\n    if (source[key] && typeof source[key] === \"object\" && !Array.isArray(source[key])) {\n      result[key] = deepMerge(result[key] || {}, source[key]);\n    } else if (source[key] !== undefined) {\n      result[key] = source[key];\n    }\n  }\n\n  return result;\n};\n\n/**\n * Create a translation function with the given language or custom translations\n * @param {string|Object} langOrTranslations - Language code or custom translations object\n * @returns {Function} Translation function\n */\nexport const createTranslator = (langOrTranslations = {}) => {\n  let translations;\n\n  if (typeof langOrTranslations === \"string\") {\n    translations = getTranslations(langOrTranslations);\n  } else {\n    const autoTranslations = getAutoTranslations();\n    translations = deepMerge(autoTranslations, langOrTranslations);\n  }\n\n  /**\n   * Get a translation by key path (e.g., \"toolbar.bold\" or \"linkTooltip.insert\")\n   * @param {string} keyPath - Dot-separated key path\n   * @param {string} fallback - Fallback value if key not found\n   * @returns {string} Translated string\n   */\n  return (keyPath, fallback = \"\") => {\n    const keys = keyPath.split(\".\");\n    let value = translations;\n\n    for (const key of keys) {\n      if (value && typeof value === \"object\" && key in value) {\n        value = value[key];\n      } else {\n        return fallback || keyPath;\n      }\n    }\n\n    return typeof value === \"string\" ? value : fallback || keyPath;\n  };\n};\n\n/**\n * Get toolbar titles for a specific language or merged with custom translations\n * @param {string|Object} langOrTranslations - Language code or translation object\n * @returns {Object} Toolbar titles object\n */\nexport const getToolbarTitles = (langOrTranslations = {}) => {\n  let translations;\n\n  if (typeof langOrTranslations === \"string\") {\n    translations = getTranslations(langOrTranslations);\n  } else {\n    const autoTranslations = getAutoTranslations();\n    translations = deepMerge(autoTranslations, langOrTranslations);\n  }\n\n  return translations.toolbar;\n};\n\n/**\n * Get heading options for a specific language or merged with custom translations\n * @param {string|Object} langOrTranslations - Language code or translation object\n * @returns {Array} Heading options array with fontSize for visual representation\n */\nexport const getHeadingOptions = (langOrTranslations = {}) => {\n  let translations;\n\n  if (typeof langOrTranslations === \"string\") {\n    translations = getTranslations(langOrTranslations);\n  } else {\n    const autoTranslations = getAutoTranslations();\n    translations = deepMerge(autoTranslations, langOrTranslations);\n  }\n\n  return [\n    { value: \"h1\", label: translations.headings.h1, fontSize: \"24px\", fontWeight: 700 },\n    { value: \"h2\", label: translations.headings.h2, fontSize: \"20px\", fontWeight: 700 },\n    { value: \"h3\", label: translations.headings.h3, fontSize: \"16px\", fontWeight: 700 },\n    { value: \"p\", label: translations.headings.p, fontSize: \"14px\", fontWeight: 400 },\n  ];\n};\n","import React, { useEffect, useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  Box,\n  Button,\n  IconButton,\n  Paper,\n  TextField,\n  Typography,\n} from \"@mui/material\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport { getAutoTranslations } from \"./i18n\";\n\n/**\n * LinkTooltip component for inserting and editing links\n * Provides a modal-like interface for link management\n */\nexport const LinkTooltip = ({\n  position,\n  onSubmit,\n  onClose,\n  initialValue = \"\",\n  isEdit = false,\n  tooltipRef,\n  storedRange,\n  translations = {},\n}) => {\n  // Get auto-detected translations and merge with custom translations\n  const baseTranslations = getAutoTranslations().linkTooltip;\n  const t = { ...baseTranslations, ...translations };\n  const [url, setUrl] = useState(initialValue);\n  const inputRef = useRef(null);\n\n  // Focus and select input when component mounts or initialValue changes\n  useEffect(() => {\n    setUrl(initialValue);\n    // Focus the input after a brief delay to ensure it's rendered\n    setTimeout(() => {\n      if (inputRef.current && typeof inputRef.current.focus === \"function\") {\n        inputRef.current.focus();\n      }\n      if (inputRef.current && typeof inputRef.current.select === \"function\") {\n        inputRef.current.select();\n      }\n    }, 50);\n  }, [initialValue]);\n\n  /**\n   * Handle form submission\n   * @param {Event} e - Form submission event\n   */\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (url.trim()) {\n      let formattedUrl = url.trim();\n      // Add https:// if no protocol is specified\n      if (!formattedUrl.match(/^https?:\\/\\//)) {\n        formattedUrl = \"https://\" + formattedUrl;\n      }\n      onSubmit(formattedUrl);\n    }\n  };\n\n  /**\n   * Handle keyboard events\n   * @param {KeyboardEvent} e - Keyboard event\n   */\n  const handleKeyDown = (e) => {\n    if (e.key === \"Escape\") {\n      onClose();\n    }\n  };\n\n  /**\n   * Handle link removal\n   * Restores selection and removes the link\n   */\n  const handleRemoveLink = () => {\n    if (storedRange) {\n      const selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(storedRange);\n    }\n    document.execCommand(\"unlink\");\n    onClose();\n  };\n\n  return (\n    <Paper\n      elevation={0}\n      ref={tooltipRef}\n      sx={{\n        position: \"absolute\",\n        left: position.x,\n        top: position.y,\n        transform: \"translateX(-50%)\",\n        zIndex: 1000,\n        p: \"48px\",\n        minWidth: 430,\n        maxWidth: 450,\n        borderRadius: \"16px\",\n        boxShadow: \"0px 4px 16px 0px rgba(87, 104, 131, 0.2)\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        gap: \"24px\",\n      }}\n    >\n      {/* Header with title and close button */}\n      <Box\n        sx={{\n          display: \"flex\",\n          alignItems: \"flex-start\",\n          justifyContent: \"space-between\",\n          gap: \"24px\",\n          width: \"100%\",\n        }}\n      >\n        <Typography\n          sx={{\n            fontFamily: \"Roboto, sans-serif\",\n            fontWeight: 700,\n            fontSize: \"24px\",\n            lineHeight: \"32px\",\n            color: \"#536886\",\n            flex: 1,\n          }}\n        >\n          {isEdit ? t.editTitle : t.insertTitle}\n        </Typography>\n        <IconButton\n          onClick={onClose}\n          sx={{\n            p: \"4px\",\n            borderRadius: \"4px\",\n            color: \"#536886\",\n            \"&:hover\": {\n              backgroundColor: \"rgba(83, 104, 134, 0.08)\",\n            },\n          }}\n        >\n          <CloseIcon sx={{ fontSize: 24 }} />\n        </IconButton>\n      </Box>\n\n      {/* URL Input */}\n      <TextField\n        inputRef={inputRef}\n        fullWidth\n        value={url}\n        onChange={(e) => setUrl(e.target.value)}\n        onKeyDown={handleKeyDown}\n        placeholder={t.placeholder}\n        variant=\"outlined\"\n        sx={{\n          \"& .MuiOutlinedInput-root\": {\n            height: \"40px\",\n            borderRadius: \"4px\",\n            fontFamily: \"Roboto, sans-serif\",\n            fontSize: \"14px\",\n            lineHeight: \"24px\",\n            color: \"#536886\",\n            \"& fieldset\": {\n              borderColor: \"#e5e8ec\",\n            },\n            \"&:hover fieldset\": {\n              borderColor: \"#0b89d1\",\n            },\n            \"&.Mui-focused fieldset\": {\n              borderColor: \"#0b89d1\",\n            },\n          },\n          \"& .MuiOutlinedInput-input\": {\n            padding: \"8px 12px\",\n          },\n        }}\n      />\n\n      {/* Action buttons */}\n      <Box\n        sx={{\n          display: \"flex\",\n          justifyContent: \"flex-end\",\n          alignItems: \"center\",\n          gap: \"16px\",\n          width: \"100%\",\n        }}\n      >\n        {isEdit && (\n          <Button\n            type=\"button\"\n            onClick={handleRemoveLink}\n            sx={{\n              backgroundColor: \"#def3ff\",\n              color: \"#0b89d1\",\n              fontFamily: \"Roboto, sans-serif\",\n              fontWeight: 700,\n              fontSize: \"14px\",\n              lineHeight: \"16px\",\n              letterSpacing: \"0.8px\",\n              textTransform: \"uppercase\",\n              padding: \"12px 16px\",\n              borderRadius: \"4px\",\n              \"&:hover\": {\n                backgroundColor: \"#c5e8fc\",\n              },\n            }}\n          >\n            {t.remove}\n          </Button>\n        )}\n        <Button\n          onClick={handleSubmit}\n          disabled={!url.trim()}\n          sx={{\n            backgroundColor: \"#0b89d1\",\n            color: \"#ffffff\",\n            fontFamily: \"Roboto, sans-serif\",\n            fontWeight: 700,\n            fontSize: \"14px\",\n            lineHeight: \"16px\",\n            letterSpacing: \"0.8px\",\n            textTransform: \"uppercase\",\n            padding: \"12px 16px\",\n            borderRadius: \"4px\",\n            \"&:hover\": {\n              backgroundColor: \"#0976b5\",\n            },\n            \"&.Mui-disabled\": {\n              backgroundColor: \"rgba(11, 137, 209, 0.5)\",\n              color: \"rgba(255, 255, 255, 0.7)\",\n            },\n          }}\n        >\n          {isEdit ? t.update : t.insert}\n        </Button>\n      </Box>\n    </Paper>\n  );\n};\n\n// PropTypes for type checking\nLinkTooltip.propTypes = {\n  /** Position object with x and y coordinates */\n  position: PropTypes.shape({\n    x: PropTypes.number.isRequired,\n    y: PropTypes.number.isRequired,\n  }).isRequired,\n  /** Callback function when link is submitted */\n  onSubmit: PropTypes.func.isRequired,\n  /** Callback function when tooltip is closed */\n  onClose: PropTypes.func.isRequired,\n  /** Initial URL value for the input field */\n  initialValue: PropTypes.string,\n  /** Whether the tooltip is in edit mode */\n  isEdit: PropTypes.bool,\n  /** Ref for the tooltip container */\n  tooltipRef: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.any }),\n  ]),\n  /** Stored range for link editing */\n  storedRange: PropTypes.object,\n  /** Custom translations for the link tooltip */\n  translations: PropTypes.shape({\n    insertTitle: PropTypes.string,\n    editTitle: PropTypes.string,\n    placeholder: PropTypes.string,\n    insert: PropTypes.string,\n    update: PropTypes.string,\n    cancel: PropTypes.string,\n    remove: PropTypes.string,\n  }),\n};\n\n// Default props\nLinkTooltip.defaultProps = {\n  initialValue: \"\",\n  isEdit: false,\n  tooltipRef: null,\n  storedRange: null,\n  translations: {},\n};\n","import React, { useState, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Box, Popover, MenuItem } from \"@mui/material\";\nimport { styled, useTheme } from \"@mui/material/styles\";\nimport { ExpandMore as ExpandMoreIcon } from \"@mui/icons-material\";\n\n/**\n * Design tokens from Figma (node-id: 32:54592)\n */\nconst tokens = {\n  spacing: {\n    spacing0_5: \"4px\",\n    spacing1: \"8px\",\n  },\n  radius: {\n    small: \"4px\",\n  },\n  typography: {\n    inputText: {\n      fontFamily: \"'Roboto', sans-serif\",\n      fontSize: \"14px\",\n      fontWeight: 400,\n      lineHeight: \"24px\",\n    },\n  },\n};\n\n/**\n * Styled container matching Figma design (node-id: 32:54592)\n */\nconst SelectContainer = styled(Box)({\n  position: \"relative\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"flex-start\",\n});\n\nconst SelectInput = styled(Box)({\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"flex-start\",\n  paddingLeft: tokens.spacing.spacing1,\n  paddingRight: 0,\n  borderRadius: tokens.radius.small,\n  cursor: \"pointer\",\n});\n\nconst DataContainer = styled(Box)({\n  display: \"flex\",\n  alignItems: \"flex-end\",\n  justifyContent: \"flex-end\",\n  gap: tokens.spacing.spacing0_5,\n});\n\nconst ContentContainer = styled(Box)({\n  display: \"flex\",\n  alignItems: \"flex-start\",\n  gap: tokens.spacing.spacing1,\n  overflow: \"hidden\",\n  padding: `${tokens.spacing.spacing0_5} 0`,\n});\n\nconst ValueText = styled(\"span\")(({ theme }) => ({\n  fontFamily: tokens.typography.inputText.fontFamily,\n  fontSize: tokens.typography.inputText.fontSize,\n  fontWeight: tokens.typography.inputText.fontWeight,\n  lineHeight: tokens.typography.inputText.lineHeight,\n  color: theme.palette.text.secondary,\n  whiteSpace: \"nowrap\",\n  overflow: \"hidden\",\n  textOverflow: \"ellipsis\",\n}));\n\nconst ButtonContainer = styled(Box)({\n  display: \"flex\",\n  alignItems: \"flex-end\",\n  justifyContent: \"center\",\n  padding: `0 ${tokens.spacing.spacing0_5}`,\n});\n\nconst IconWrapper = styled(Box)(({ open }) => ({\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  height: \"32px\",\n  padding: `${tokens.spacing.spacing1} 0`,\n  borderRadius: tokens.radius.small,\n  \"& > div\": {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: tokens.spacing.spacing0_5,\n    borderRadius: tokens.radius.small,\n    overflow: \"hidden\",\n    transition: \"transform 0.2s ease\",\n    transform: open ? \"rotate(180deg)\" : \"rotate(0deg)\",\n  },\n}));\n\n/**\n * CustomSelect component matching Figma design (node-id: 32:54592)\n * A minimal styled select dropdown without border\n */\nexport const CustomSelect = ({\n  value,\n  options = [],\n  onChange,\n  placeholder = \"Select...\",\n  disabled = false,\n  sx = {},\n}) => {\n  const theme = useTheme();\n  const [open, setOpen] = useState(false);\n  const anchorRef = useRef(null);\n\n  const selectedOption = options.find((opt) => opt.value === value);\n  const displayValue = selectedOption?.label || placeholder;\n\n  const handleClick = () => {\n    if (!disabled) {\n      setOpen(true);\n    }\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleSelect = (optionValue) => {\n    if (onChange) {\n      onChange({ target: { value: optionValue } });\n    }\n    handleClose();\n  };\n\n  return (\n    <SelectContainer className=\"notranslate\" translate=\"no\" sx={sx}>\n      <SelectInput\n        ref={anchorRef}\n        onClick={handleClick}\n        tabIndex={disabled ? -1 : 0}\n        onKeyDown={(e) => {\n          if (e.key === \"Enter\" || e.key === \" \") {\n            e.preventDefault();\n            handleClick();\n          }\n        }}\n        role=\"combobox\"\n        aria-expanded={open}\n        aria-haspopup=\"listbox\"\n        sx={{\n          opacity: disabled ? 0.5 : 1,\n          pointerEvents: disabled ? \"none\" : \"auto\",\n        }}\n      >\n        <DataContainer>\n          <ContentContainer>\n            <ValueText>{displayValue}</ValueText>\n          </ContentContainer>\n          <ButtonContainer>\n            <IconWrapper open={open}>\n              <div>\n                <ExpandMoreIcon\n                  sx={{\n                    fontSize: 24,\n                    color: theme.palette.text.secondary,\n                  }}\n                />\n              </div>\n            </IconWrapper>\n          </ButtonContainer>\n        </DataContainer>\n      </SelectInput>\n\n      <Popover\n        open={open}\n        anchorEl={anchorRef.current}\n        onClose={handleClose}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"left\",\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"left\",\n        }}\n        slotProps={{\n          paper: {\n            sx: {\n              mt: 0.5,\n              minWidth: 200,\n              borderRadius: tokens.radius.small,\n              backgroundColor: theme.palette.background.paper,\n              boxShadow: \"0px 4px 16px rgba(29, 29, 43, 0.4)\",\n            },\n          },\n        }}\n      >\n        <Box sx={{ py: \"4px\" }}>\n          {options.map((option) => (\n            <MenuItem\n              key={option.value}\n              onClick={() => handleSelect(option.value)}\n              selected={option.value === value}\n              sx={{\n                minHeight: \"auto !important\",\n                height: \"auto !important\",\n                minWidth: 200,\n                pl: \"16px\",\n                pr: \"12px\",\n                py: \"6px\",\n                fontFamily: tokens.typography.inputText.fontFamily,\n                color: theme.palette.text.secondary,\n                \"&.Mui-selected\": {\n                  backgroundColor: theme.palette.action.selected,\n                },\n                \"&.Mui-selected:hover\": {\n                  backgroundColor: theme.palette.action.hover,\n                },\n                \"&:hover\": {\n                  backgroundColor: theme.palette.action.hover,\n                },\n              }}\n            >\n              <Box\n                sx={{\n                  fontSize: option.fontSize || tokens.typography.inputText.fontSize,\n                  fontWeight: option.fontWeight || tokens.typography.inputText.fontWeight,\n                  lineHeight: 1.3,\n                }}\n              >\n                {option.label}\n              </Box>\n            </MenuItem>\n          ))}\n        </Box>\n      </Popover>\n    </SelectContainer>\n  );\n};\n\nCustomSelect.propTypes = {\n  /** Current selected value */\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  /** Array of options: [{ value: string, label: string, fontSize?: string, fontWeight?: number }] */\n  options: PropTypes.arrayOf(\n    PropTypes.shape({\n      value: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n        .isRequired,\n      label: PropTypes.string.isRequired,\n      fontSize: PropTypes.string,\n      fontWeight: PropTypes.number,\n    })\n  ).isRequired,\n  /** Callback when value changes */\n  onChange: PropTypes.func,\n  /** Placeholder text when no value selected */\n  placeholder: PropTypes.string,\n  /** Whether the select is disabled */\n  disabled: PropTypes.bool,\n  /** Additional styles */\n  sx: PropTypes.object,\n};\n\nCustomSelect.defaultProps = {\n  value: undefined,\n  onChange: undefined,\n  placeholder: \"Select...\",\n  disabled: false,\n  sx: {},\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Box, Popover, SvgIcon } from \"@mui/material\";\n\n/**\n * Check icon for selected color\n */\nconst CheckIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 24 24\">\n    <path\n      d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Default color palette matching Figma design\n * 5 rows x 4 columns = 20 colors\n */\nexport const FIGMA_TEXT_COLORS = [\n  // Row 1: Alert/Status colors + grey\n  \"#45bb36\", // Success green\n  \"#f2b04f\", // Warning orange\n  \"#ef5b5c\", // Error red\n  \"#536886\", // Grey/main\n  // Row 2: Red, Pink, Purple shades\n  \"#f44336\", // Red\n  \"#e91e63\", // Pink\n  \"#9c27b0\", // Purple\n  \"#673ab7\", // Deep Purple\n  // Row 3: Blue shades\n  \"#3f51b5\", // Indigo\n  \"#2196f3\", // Blue\n  \"#03a9f4\", // Light Blue\n  \"#00bcd4\", // Cyan\n  // Row 4: Green shades\n  \"#009688\", // Teal\n  \"#4caf50\", // Green\n  \"#8bc34a\", // Light Green\n  \"#cddc39\", // Lime\n  // Row 5: Yellow/Orange shades\n  \"#ffeb3b\", // Yellow\n  \"#ffc107\", // Amber\n  \"#ff9800\", // Orange\n  \"#ff5722\", // Deep Orange\n];\n\n/**\n * Determines if a color is light (for contrast calculation)\n * @param {string} hexColor - Hex color code\n * @returns {boolean} True if color is light\n */\nconst isLightColor = (hexColor) => {\n  const hex = hexColor.replace(\"#\", \"\");\n  const r = parseInt(hex.substr(0, 2), 16);\n  const g = parseInt(hex.substr(2, 2), 16);\n  const b = parseInt(hex.substr(4, 2), 16);\n  // Using relative luminance formula\n  const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\n  return luminance > 0.6;\n};\n\n/**\n * ColorPicker component\n * A popover with a grid of color swatches\n *\n * @param {Object} props\n * @param {boolean} props.open - Whether the popover is open\n * @param {HTMLElement} props.anchorEl - Anchor element for positioning\n * @param {Function} props.onClose - Callback when popover closes\n * @param {Function} props.onColorSelect - Callback when color is selected\n * @param {string} props.selectedColor - Currently selected color\n * @param {Array} props.colors - Array of color hex values\n */\nexport const ColorPicker = ({\n  open,\n  anchorEl,\n  onClose,\n  onColorSelect,\n  selectedColor,\n  colors = FIGMA_TEXT_COLORS,\n}) => {\n  const handleColorClick = (color) => {\n    onColorSelect(color);\n    onClose();\n  };\n\n  return (\n    <Popover\n      open={open}\n      anchorEl={anchorEl}\n      onClose={onClose}\n      anchorOrigin={{\n        vertical: \"bottom\",\n        horizontal: \"left\",\n      }}\n      transformOrigin={{\n        vertical: \"top\",\n        horizontal: \"left\",\n      }}\n      slotProps={{\n        paper: {\n          sx: {\n            borderRadius: \"8px\",\n            boxShadow: \"0px 4px 16px 0px rgba(87, 104, 131, 0.2)\",\n          },\n        },\n      }}\n    >\n      <Box\n        sx={{\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: \"4px\",\n          p: \"8px\",\n          bgcolor: \"white\",\n          borderRadius: \"8px\",\n        }}\n      >\n        {/* Render rows of 4 colors each */}\n        {Array.from({ length: Math.ceil(colors.length / 4) }, (_, rowIndex) => (\n          <Box\n            key={`row-${rowIndex}`}\n            sx={{\n              display: \"flex\",\n              gap: \"4px\",\n            }}\n          >\n            {colors.slice(rowIndex * 4, rowIndex * 4 + 4).map((color) => {\n              const isSelected = selectedColor?.toLowerCase() === color.toLowerCase();\n              const isLight = isLightColor(color);\n\n              return (\n                <Box\n                  key={color}\n                  onClick={() => handleColorClick(color)}\n                  sx={{\n                    position: \"relative\",\n                    width: 32,\n                    height: 32,\n                    borderRadius: \"4px\",\n                    cursor: \"pointer\",\n                    border: \"1px solid #e5e8ec\",\n                    bgcolor: color,\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    transition: \"transform 0.1s ease\",\n                    \"&:hover\": {\n                      transform: \"scale(1.05)\",\n                    },\n                  }}\n                >\n                  {isSelected && (\n                    <CheckIcon\n                      sx={{\n                        fontSize: 16,\n                        color: isLight ? \"rgba(0, 0, 0, 0.7)\" : \"white\",\n                      }}\n                    />\n                  )}\n                </Box>\n              );\n            })}\n          </Box>\n        ))}\n      </Box>\n    </Popover>\n  );\n};\n\nColorPicker.propTypes = {\n  /** Whether the popover is open */\n  open: PropTypes.bool.isRequired,\n  /** Anchor element for positioning */\n  anchorEl: PropTypes.instanceOf(Element),\n  /** Callback when popover closes */\n  onClose: PropTypes.func.isRequired,\n  /** Callback when color is selected */\n  onColorSelect: PropTypes.func.isRequired,\n  /** Currently selected color */\n  selectedColor: PropTypes.string,\n  /** Array of color hex values */\n  colors: PropTypes.arrayOf(PropTypes.string),\n};\n\nColorPicker.defaultProps = {\n  anchorEl: null,\n  selectedColor: \"#536886\",\n  colors: FIGMA_TEXT_COLORS,\n};\n","import React, { useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  FormatClear,\n  FormatAlignLeft,\n  FormatAlignCenter,\n  FormatAlignRight,\n  FormatAlignJustify,\n  Search as SearchIcon,\n  HelpOutline as HelpIcon,\n  ExpandMore as ExpandMoreIcon,\n} from \"@mui/icons-material\";\n\nimport { Box, Divider, IconButton, Tooltip, SvgIcon } from \"@mui/material\";\nimport { useTheme } from \"@mui/material/styles\";\n\n/**\n * Custom Undo icon matching Figma design\n */\nconst UndoIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 16 15\">\n    <path\n      d=\"M3.575 14.575C3.29167 14.575 3.05417 14.4792 2.8625 14.2875C2.67083 14.0958 2.575 13.8583 2.575 13.575C2.575 13.2917 2.67083 13.0542 2.8625 12.8625C3.05417 12.6708 3.29167 12.575 3.575 12.575H9.675C10.725 12.575 11.6375 12.2417 12.4125 11.575C13.1875 10.9083 13.575 10.075 13.575 9.075C13.575 8.075 13.1875 7.24167 12.4125 6.575C11.6375 5.90833 10.725 5.575 9.675 5.575H3.375L5.275 7.475C5.45833 7.65833 5.55 7.89167 5.55 8.175C5.55 8.45833 5.45833 8.69167 5.275 8.875C5.09167 9.05833 4.85833 9.15 4.575 9.15C4.29167 9.15 4.05833 9.05833 3.875 8.875L0.275 5.275C0.175 5.175 0.104167 5.06667 0.0625 4.95C0.0208333 4.83333 0 4.70833 0 4.575C0 4.44167 0.0208333 4.31667 0.0625 4.2C0.104167 4.08333 0.175 3.975 0.275 3.875L3.875 0.275C4.05833 0.0916667 4.29167 0 4.575 0C4.85833 0 5.09167 0.0916667 5.275 0.275C5.45833 0.458333 5.55 0.691667 5.55 0.975C5.55 1.25833 5.45833 1.49167 5.275 1.675L3.375 3.575H9.675C11.2917 3.575 12.6792 4.1 13.8375 5.15C14.9958 6.2 15.575 7.50833 15.575 9.075C15.575 10.6417 14.9958 11.95 13.8375 13C12.6792 14.05 11.2917 14.575 9.675 14.575H3.575Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Redo icon matching Figma design\n */\nconst RedoIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 16 15\">\n    <path\n      d=\"M12.2 5.575H5.9C4.85 5.575 3.9375 5.90833 3.1625 6.575C2.3875 7.24167 2 8.075 2 9.075C2 10.075 2.3875 10.9083 3.1625 11.575C3.9375 12.2417 4.85 12.575 5.9 12.575H12C12.2833 12.575 12.5208 12.6708 12.7125 12.8625C12.9042 13.0542 13 13.2917 13 13.575C13 13.8583 12.9042 14.0958 12.7125 14.2875C12.5208 14.4792 12.2833 14.575 12 14.575H5.9C4.28333 14.575 2.89583 14.05 1.7375 13C0.579167 11.95 0 10.6417 0 9.075C0 7.50833 0.579167 6.2 1.7375 5.15C2.89583 4.1 4.28333 3.575 5.9 3.575H12.2L10.3 1.675C10.1167 1.49167 10.025 1.25833 10.025 0.975C10.025 0.691667 10.1167 0.458333 10.3 0.275C10.4833 0.0916667 10.7167 0 11 0C11.2833 0 11.5167 0.0916667 11.7 0.275L15.3 3.875C15.4 3.975 15.4708 4.08333 15.5125 4.2C15.5542 4.31667 15.575 4.44167 15.575 4.575C15.575 4.70833 15.5542 4.83333 15.5125 4.95C15.4708 5.06667 15.4 5.175 15.3 5.275L11.7 8.875C11.5167 9.05833 11.2833 9.15 11 9.15C10.7167 9.15 10.4833 9.05833 10.3 8.875C10.1167 8.69167 10.025 8.45833 10.025 8.175C10.025 7.89167 10.1167 7.65833 10.3 7.475L12.2 5.575Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Strikethrough icon matching Figma design\n */\nconst FormatStrikethroughIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 20 16\">\n    <path\n      d=\"M1 10C0.716667 10 0.479167 9.90417 0.2875 9.7125C0.0958333 9.52083 0 9.28333 0 9C0 8.71667 0.0958333 8.47917 0.2875 8.2875C0.479167 8.09583 0.716667 8 1 8H19C19.2833 8 19.5208 8.09583 19.7125 8.2875C19.9042 8.47917 20 8.71667 20 9C20 9.28333 19.9042 9.52083 19.7125 9.7125C19.5208 9.90417 19.2833 10 19 10H1ZM8.5 6V3H4.5C4.08333 3 3.72917 2.85417 3.4375 2.5625C3.14583 2.27083 3 1.91667 3 1.5C3 1.08333 3.14583 0.729167 3.4375 0.4375C3.72917 0.145833 4.08333 0 4.5 0H15.5C15.9167 0 16.2708 0.145833 16.5625 0.4375C16.8542 0.729167 17 1.08333 17 1.5C17 1.91667 16.8542 2.27083 16.5625 2.5625C16.2708 2.85417 15.9167 3 15.5 3H11.5V6H8.5ZM8.5 12H11.5V14.5C11.5 14.9167 11.3542 15.2708 11.0625 15.5625C10.7708 15.8542 10.4167 16 10 16C9.58333 16 9.22917 15.8542 8.9375 15.5625C8.64583 15.2708 8.5 14.9167 8.5 14.5V12Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Bold icon matching Figma design\n */\nconst BoldIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"-2 -1 15 16\">\n    <path\n      d=\"M2 14C1.45 14 0.979167 13.8042 0.5875 13.4125C0.195833 13.0208 0 12.55 0 12V2C0 1.45 0.195833 0.979167 0.5875 0.5875C0.979167 0.195833 1.45 0 2 0H5.525C6.60833 0 7.60833 0.333333 8.525 1C9.44167 1.66667 9.9 2.59167 9.9 3.775C9.9 4.625 9.70833 5.27917 9.325 5.7375C8.94167 6.19583 8.58333 6.525 8.25 6.725C8.66667 6.90833 9.12917 7.25 9.6375 7.75C10.1458 8.25 10.4 9 10.4 10C10.4 11.4833 9.85833 12.5208 8.775 13.1125C7.69167 13.7042 6.675 14 5.725 14H2ZM3.025 11.2H5.625C6.425 11.2 6.9125 10.9958 7.0875 10.5875C7.2625 10.1792 7.35 9.88333 7.35 9.7C7.35 9.51667 7.2625 9.22083 7.0875 8.8125C6.9125 8.40417 6.4 8.2 5.55 8.2H3.025V11.2ZM3.025 5.5H5.35C5.9 5.5 6.3 5.35833 6.55 5.075C6.8 4.79167 6.925 4.475 6.925 4.125C6.925 3.725 6.78333 3.4 6.5 3.15C6.21667 2.9 5.85 2.775 5.4 2.775H3.025V5.5Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Italic icon matching Figma design\n */\nconst ItalicIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"-1.5 -1 16 16\">\n    <path\n      d=\"M1.25 14C0.9 14 0.604167 13.8792 0.3625 13.6375C0.120833 13.3958 0 13.1 0 12.75C0 12.4 0.120833 12.1042 0.3625 11.8625C0.604167 11.6208 0.9 11.5 1.25 11.5H4L7 2.5H4.25C3.9 2.5 3.60417 2.37917 3.3625 2.1375C3.12083 1.89583 3 1.6 3 1.25C3 0.9 3.12083 0.604167 3.3625 0.3625C3.60417 0.120833 3.9 0 4.25 0H11.75C12.1 0 12.3958 0.120833 12.6375 0.3625C12.8792 0.604167 13 0.9 13 1.25C13 1.6 12.8792 1.89583 12.6375 2.1375C12.3958 2.37917 12.1 2.5 11.75 2.5H9.5L6.5 11.5H8.75C9.1 11.5 9.39583 11.6208 9.6375 11.8625C9.87917 12.1042 10 12.4 10 12.75C10 13.1 9.87917 13.3958 9.6375 13.6375C9.39583 13.8792 9.1 14 8.75 14H1.25Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Underline icon matching Figma design\n */\nconst UnderlineIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 14 18\">\n    <path\n      d=\"M1 18C0.716667 18 0.479167 17.9042 0.2875 17.7125C0.0958333 17.5208 0 17.2833 0 17C0 16.7167 0.0958333 16.4792 0.2875 16.2875C0.479167 16.0958 0.716667 16 1 16H13C13.2833 16 13.5208 16.0958 13.7125 16.2875C13.9042 16.4792 14 16.7167 14 17C14 17.2833 13.9042 17.5208 13.7125 17.7125C13.5208 17.9042 13.2833 18 13 18H1ZM7 14C5.31667 14 4.00833 13.475 3.075 12.425C2.14167 11.375 1.675 9.98333 1.675 8.25V1.275C1.675 0.925 1.80417 0.625 2.0625 0.375C2.32083 0.125 2.625 0 2.975 0C3.325 0 3.625 0.125 3.875 0.375C4.125 0.625 4.25 0.925 4.25 1.275V8.4C4.25 9.33333 4.48333 10.0917 4.95 10.675C5.41667 11.2583 6.1 11.55 7 11.55C7.9 11.55 8.58333 11.2583 9.05 10.675C9.51667 10.0917 9.75 9.33333 9.75 8.4V1.275C9.75 0.925 9.87917 0.625 10.1375 0.375C10.3958 0.125 10.7 0 11.05 0C11.4 0 11.7 0.125 11.95 0.375C12.2 0.625 12.325 0.925 12.325 1.275V8.25C12.325 9.98333 11.8583 11.375 10.925 12.425C9.99167 13.475 8.68333 14 7 14Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Text Color icon matching Figma design (A letter only, without underline)\n */\nconst TextColorIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 20 14\">\n    <path\n      d=\"M5.125 14C4.74167 14 4.4375 13.8375 4.2125 13.5125C3.9875 13.1875 3.94167 12.8417 4.075 12.475L8.475 0.75C8.55833 0.516667 8.7 0.333333 8.9 0.2C9.1 0.0666667 9.31667 0 9.55 0H10.45C10.7 0 10.9208 0.0666667 11.1125 0.2C11.3042 0.333333 11.4417 0.516667 11.525 0.75L15.95 12.5C16.0833 12.8667 16.0375 13.2083 15.8125 13.525C15.5875 13.8417 15.2833 14 14.9 14C14.6667 14 14.45 13.9333 14.25 13.8C14.05 13.6667 13.9083 13.4833 13.825 13.25L12.85 10.4H7.2L6.175 13.275C6.09167 13.5083 5.95417 13.6875 5.7625 13.8125C5.57083 13.9375 5.35833 14 5.125 14ZM7.9 8.4H12.1L10.05 2.6H9.95L7.9 8.4Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Bullet List icon matching Figma design\n */\nconst BulletListIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 18 16\">\n    <path\n      d=\"M7 15C6.71667 15 6.47917 14.9042 6.2875 14.7125C6.09583 14.5208 6 14.2833 6 14C6 13.7167 6.09583 13.4792 6.2875 13.2875C6.47917 13.0958 6.71667 13 7 13H17C17.2833 13 17.5208 13.0958 17.7125 13.2875C17.9042 13.4792 18 13.7167 18 14C18 14.2833 17.9042 14.5208 17.7125 14.7125C17.5208 14.9042 17.2833 15 17 15H7ZM7 9C6.71667 9 6.47917 8.90417 6.2875 8.7125C6.09583 8.52083 6 8.28333 6 8C6 7.71667 6.09583 7.47917 6.2875 7.2875C6.47917 7.09583 6.71667 7 7 7H17C17.2833 7 17.5208 7.09583 17.7125 7.2875C17.9042 7.47917 18 7.71667 18 8C18 8.28333 17.9042 8.52083 17.7125 8.7125C17.5208 8.90417 17.2833 9 17 9H7ZM7 3C6.71667 3 6.47917 2.90417 6.2875 2.7125C6.09583 2.52083 6 2.28333 6 2C6 1.71667 6.09583 1.47917 6.2875 1.2875C6.47917 1.09583 6.71667 1 7 1H17C17.2833 1 17.5208 1.09583 17.7125 1.2875C17.9042 1.47917 18 1.71667 18 2C18 2.28333 17.9042 2.52083 17.7125 2.7125C17.5208 2.90417 17.2833 3 17 3H7ZM2 16C1.45 16 0.979167 15.8042 0.5875 15.4125C0.195833 15.0208 0 14.55 0 14C0 13.45 0.195833 12.9792 0.5875 12.5875C0.979167 12.1958 1.45 12 2 12C2.55 12 3.02083 12.1958 3.4125 12.5875C3.80417 12.9792 4 13.45 4 14C4 14.55 3.80417 15.0208 3.4125 15.4125C3.02083 15.8042 2.55 16 2 16ZM2 10C1.45 10 0.979167 9.80417 0.5875 9.4125C0.195833 9.02083 0 8.55 0 8C0 7.45 0.195833 6.97917 0.5875 6.5875C0.979167 6.19583 1.45 6 2 6C2.55 6 3.02083 6.19583 3.4125 6.5875C3.80417 6.97917 4 7.45 4 8C4 8.55 3.80417 9.02083 3.4125 9.4125C3.02083 9.80417 2.55 10 2 10ZM2 4C1.45 4 0.979167 3.80417 0.5875 3.4125C0.195833 3.02083 0 2.55 0 2C0 1.45 0.195833 0.979167 0.5875 0.5875C0.979167 0.195833 1.45 0 2 0C2.55 0 3.02083 0.195833 3.4125 0.5875C3.80417 0.979167 4 1.45 4 2C4 2.55 3.80417 3.02083 3.4125 3.4125C3.02083 3.80417 2.55 4 2 4Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Ordered List icon matching Figma design\n */\nconst OrderedListIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 18 20\">\n    <path\n      d=\"M0.75 20C0.533333 20 0.354167 19.9292 0.2125 19.7875C0.0708333 19.6458 0 19.4667 0 19.25C0 19.0333 0.0708333 18.8542 0.2125 18.7125C0.354167 18.5708 0.533333 18.5 0.75 18.5H2.5V17.75H1.75C1.53333 17.75 1.35417 17.6792 1.2125 17.5375C1.07083 17.3958 1 17.2167 1 17C1 16.7833 1.07083 16.6042 1.2125 16.4625C1.35417 16.3208 1.53333 16.25 1.75 16.25H2.5V15.5H0.75C0.533333 15.5 0.354167 15.4292 0.2125 15.2875C0.0708333 15.1458 0 14.9667 0 14.75C0 14.5333 0.0708333 14.3542 0.2125 14.2125C0.354167 14.0708 0.533333 14 0.75 14H3C3.28333 14 3.52083 14.0958 3.7125 14.2875C3.90417 14.4792 4 14.7167 4 15V16C4 16.2833 3.90417 16.5208 3.7125 16.7125C3.52083 16.9042 3.28333 17 3 17C3.28333 17 3.52083 17.0958 3.7125 17.2875C3.90417 17.4792 4 17.7167 4 18V19C4 19.2833 3.90417 19.5208 3.7125 19.7125C3.52083 19.9042 3.28333 20 3 20H0.75ZM0.75 13C0.533333 13 0.354167 12.9292 0.2125 12.7875C0.0708333 12.6458 0 12.4667 0 12.25V10.25C0 9.96667 0.0958333 9.72917 0.2875 9.5375C0.479167 9.34583 0.716667 9.25 1 9.25H2.5V8.5H0.75C0.533333 8.5 0.354167 8.42917 0.2125 8.2875C0.0708333 8.14583 0 7.96667 0 7.75C0 7.53333 0.0708333 7.35417 0.2125 7.2125C0.354167 7.07083 0.533333 7 0.75 7H3C3.28333 7 3.52083 7.09583 3.7125 7.2875C3.90417 7.47917 4 7.71667 4 8V9.75C4 10.0333 3.90417 10.2708 3.7125 10.4625C3.52083 10.6542 3.28333 10.75 3 10.75H1.5V11.5H3.25C3.46667 11.5 3.64583 11.5708 3.7875 11.7125C3.92917 11.8542 4 12.0333 4 12.25C4 12.4667 3.92917 12.6458 3.7875 12.7875C3.64583 12.9292 3.46667 13 3.25 13H0.75ZM2.25 6C2.03333 6 1.85417 5.92917 1.7125 5.7875C1.57083 5.64583 1.5 5.46667 1.5 5.25V1.5H0.75C0.533333 1.5 0.354167 1.42917 0.2125 1.2875C0.0708333 1.14583 0 0.966667 0 0.75C0 0.533333 0.0708333 0.354167 0.2125 0.2125C0.354167 0.0708333 0.533333 0 0.75 0H2.25C2.46667 0 2.64583 0.0708333 2.7875 0.2125C2.92917 0.354167 3 0.533333 3 0.75V5.25C3 5.46667 2.92917 5.64583 2.7875 5.7875C2.64583 5.92917 2.46667 6 2.25 6ZM7 17C6.71667 17 6.47917 16.9042 6.2875 16.7125C6.09583 16.5208 6 16.2833 6 16C6 15.7167 6.09583 15.4792 6.2875 15.2875C6.47917 15.0958 6.71667 15 7 15H17C17.2833 15 17.5208 15.0958 17.7125 15.2875C17.9042 15.4792 18 15.7167 18 16C18 16.2833 17.9042 16.5208 17.7125 16.7125C17.5208 16.9042 17.2833 17 17 17H7ZM7 11C6.71667 11 6.47917 10.9042 6.2875 10.7125C6.09583 10.5208 6 10.2833 6 10C6 9.71667 6.09583 9.47917 6.2875 9.2875C6.47917 9.09583 6.71667 9 7 9H17C17.2833 9 17.5208 9.09583 17.7125 9.2875C17.9042 9.47917 18 9.71667 18 10C18 10.2833 17.9042 10.5208 17.7125 10.7125C17.5208 10.9042 17.2833 11 17 11H7ZM7 5C6.71667 5 6.47917 4.90417 6.2875 4.7125C6.09583 4.52083 6 4.28333 6 4C6 3.71667 6.09583 3.47917 6.2875 3.2875C6.47917 3.09583 6.71667 3 7 3H17C17.2833 3 17.5208 3.09583 17.7125 3.2875C17.9042 3.47917 18 3.71667 18 4C18 4.28333 17.9042 4.52083 17.7125 4.7125C17.5208 4.90417 17.2833 5 17 5H7Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Indent Decrease icon matching Figma design\n */\nconst IndentDecreaseIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 18 18\">\n    <path\n      d=\"M1 18C0.716667 18 0.479167 17.9042 0.2875 17.7125C0.0958333 17.5208 0 17.2833 0 17C0 16.7167 0.0958333 16.4792 0.2875 16.2875C0.479167 16.0958 0.716667 16 1 16H17C17.2833 16 17.5208 16.0958 17.7125 16.2875C17.9042 16.4792 18 16.7167 18 17C18 17.2833 17.9042 17.5208 17.7125 17.7125C17.5208 17.9042 17.2833 18 17 18H1ZM9 14C8.71667 14 8.47917 13.9042 8.2875 13.7125C8.09583 13.5208 8 13.2833 8 13C8 12.7167 8.09583 12.4792 8.2875 12.2875C8.47917 12.0958 8.71667 12 9 12H17C17.2833 12 17.5208 12.0958 17.7125 12.2875C17.9042 12.4792 18 12.7167 18 13C18 13.2833 17.9042 13.5208 17.7125 13.7125C17.5208 13.9042 17.2833 14 17 14H9ZM9 10C8.71667 10 8.47917 9.90417 8.2875 9.7125C8.09583 9.52083 8 9.28333 8 9C8 8.71667 8.09583 8.47917 8.2875 8.2875C8.47917 8.09583 8.71667 8 9 8H17C17.2833 8 17.5208 8.09583 17.7125 8.2875C17.9042 8.47917 18 8.71667 18 9C18 9.28333 17.9042 9.52083 17.7125 9.7125C17.5208 9.90417 17.2833 10 17 10H9ZM9 6C8.71667 6 8.47917 5.90417 8.2875 5.7125C8.09583 5.52083 8 5.28333 8 5C8 4.71667 8.09583 4.47917 8.2875 4.2875C8.47917 4.09583 8.71667 4 9 4H17C17.2833 4 17.5208 4.09583 17.7125 4.2875C17.9042 4.47917 18 4.71667 18 5C18 5.28333 17.9042 5.52083 17.7125 5.7125C17.5208 5.90417 17.2833 6 17 6H9ZM1 2C0.716667 2 0.479167 1.90417 0.2875 1.7125C0.0958333 1.52083 0 1.28333 0 1C0 0.716667 0.0958333 0.479167 0.2875 0.2875C0.479167 0.0958333 0.716667 0 1 0H17C17.2833 0 17.5208 0.0958333 17.7125 0.2875C17.9042 0.479167 18 0.716667 18 1C18 1.28333 17.9042 1.52083 17.7125 1.7125C17.5208 1.90417 17.2833 2 17 2H1ZM3.15 12.15L0.35 9.35C0.25 9.25 0.2 9.13333 0.2 9C0.2 8.86667 0.25 8.75 0.35 8.65L3.15 5.85C3.31667 5.68333 3.5 5.64167 3.7 5.725C3.9 5.80833 4 5.96667 4 6.2V11.8C4 12.0333 3.9 12.1917 3.7 12.275C3.5 12.3583 3.31667 12.3167 3.15 12.15Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Indent Increase icon matching Figma design\n */\nconst IndentIncreaseIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 18 18\">\n    <path\n      d=\"M1 18C0.716667 18 0.479167 17.9042 0.2875 17.7125C0.0958333 17.5208 0 17.2833 0 17C0 16.7167 0.0958333 16.4792 0.2875 16.2875C0.479167 16.0958 0.716667 16 1 16H17C17.2833 16 17.5208 16.0958 17.7125 16.2875C17.9042 16.4792 18 16.7167 18 17C18 17.2833 17.9042 17.5208 17.7125 17.7125C17.5208 17.9042 17.2833 18 17 18H1ZM9 14C8.71667 14 8.47917 13.9042 8.2875 13.7125C8.09583 13.5208 8 13.2833 8 13C8 12.7167 8.09583 12.4792 8.2875 12.2875C8.47917 12.0958 8.71667 12 9 12H17C17.2833 12 17.5208 12.0958 17.7125 12.2875C17.9042 12.4792 18 12.7167 18 13C18 13.2833 17.9042 13.5208 17.7125 13.7125C17.5208 13.9042 17.2833 14 17 14H9ZM9 10C8.71667 10 8.47917 9.90417 8.2875 9.7125C8.09583 9.52083 8 9.28333 8 9C8 8.71667 8.09583 8.47917 8.2875 8.2875C8.47917 8.09583 8.71667 8 9 8H17C17.2833 8 17.5208 8.09583 17.7125 8.2875C17.9042 8.47917 18 8.71667 18 9C18 9.28333 17.9042 9.52083 17.7125 9.7125C17.5208 9.90417 17.2833 10 17 10H9ZM9 6C8.71667 6 8.47917 5.90417 8.2875 5.7125C8.09583 5.52083 8 5.28333 8 5C8 4.71667 8.09583 4.47917 8.2875 4.2875C8.47917 4.09583 8.71667 4 9 4H17C17.2833 4 17.5208 4.09583 17.7125 4.2875C17.9042 4.47917 18 4.71667 18 5C18 5.28333 17.9042 5.52083 17.7125 5.7125C17.5208 5.90417 17.2833 6 17 6H9ZM1 2C0.716667 2 0.479167 1.90417 0.2875 1.7125C0.0958333 1.52083 0 1.28333 0 1C0 0.716667 0.0958333 0.479167 0.2875 0.2875C0.479167 0.0958333 0.716667 0 1 0H17C17.2833 0 17.5208 0.0958333 17.7125 0.2875C17.9042 0.479167 18 0.716667 18 1C18 1.28333 17.9042 1.52083 17.7125 1.7125C17.5208 1.90417 17.2833 2 17 2H1ZM0.85 12.15C0.683333 12.3167 0.5 12.3583 0.3 12.275C0.1 12.1917 0 12.0333 0 11.8V6.2C0 5.96667 0.1 5.80833 0.3 5.725C0.5 5.64167 0.683333 5.68333 0.85 5.85L3.65 8.65C3.75 8.75 3.8 8.86667 3.8 9C3.8 9.13333 3.75 9.25 3.65 9.35L0.85 12.15Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Link icon matching Figma design\n */\nconst LinkIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 20 10\">\n    <path\n      d=\"M5 10C3.61667 10 2.4375 9.5125 1.4625 8.5375C0.4875 7.5625 0 6.38333 0 5C0 3.61667 0.4875 2.4375 1.4625 1.4625C2.4375 0.4875 3.61667 0 5 0H8C8.28333 0 8.52083 0.0958333 8.7125 0.2875C8.90417 0.479167 9 0.716667 9 1C9 1.28333 8.90417 1.52083 8.7125 1.7125C8.52083 1.90417 8.28333 2 8 2H5C4.16667 2 3.45833 2.29167 2.875 2.875C2.29167 3.45833 2 4.16667 2 5C2 5.83333 2.29167 6.54167 2.875 7.125C3.45833 7.70833 4.16667 8 5 8H8C8.28333 8 8.52083 8.09583 8.7125 8.2875C8.90417 8.47917 9 8.71667 9 9C9 9.28333 8.90417 9.52083 8.7125 9.7125C8.52083 9.90417 8.28333 10 8 10H5ZM7 6C6.71667 6 6.47917 5.90417 6.2875 5.7125C6.09583 5.52083 6 5.28333 6 5C6 4.71667 6.09583 4.47917 6.2875 4.2875C6.47917 4.09583 6.71667 4 7 4H13C13.2833 4 13.5208 4.09583 13.7125 4.2875C13.9042 4.47917 14 4.71667 14 5C14 5.28333 13.9042 5.52083 13.7125 5.7125C13.5208 5.90417 13.2833 6 13 6H7ZM12 10C11.7167 10 11.4792 9.90417 11.2875 9.7125C11.0958 9.52083 11 9.28333 11 9C11 8.71667 11.0958 8.47917 11.2875 8.2875C11.4792 8.09583 11.7167 8 12 8H15C15.8333 8 16.5417 7.70833 17.125 7.125C17.7083 6.54167 18 5.83333 18 5C18 4.16667 17.7083 3.45833 17.125 2.875C16.5417 2.29167 15.8333 2 15 2H12C11.7167 2 11.4792 1.90417 11.2875 1.7125C11.0958 1.52083 11 1.28333 11 1C11 0.716667 11.0958 0.479167 11.2875 0.2875C11.4792 0.0958333 11.7167 0 12 0H15C16.3833 0 17.5625 0.4875 18.5375 1.4625C19.5125 2.4375 20 3.61667 20 5C20 6.38333 19.5125 7.5625 18.5375 8.5375C17.5625 9.5125 16.3833 10 15 10H12Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\n/**\n * Custom Image icon matching Figma design\n */\nconst ImageIcon = (props) => (\n  <SvgIcon {...props} viewBox=\"0 0 18 18\">\n    <path\n      d=\"M2 18C1.45 18 0.979167 17.8042 0.5875 17.4125C0.195833 17.0208 0 16.55 0 16V2C0 1.45 0.195833 0.979167 0.5875 0.5875C0.979167 0.195833 1.45 0 2 0H16C16.55 0 17.0208 0.195833 17.4125 0.5875C17.8042 0.979167 18 1.45 18 2V16C18 16.55 17.8042 17.0208 17.4125 17.4125C17.0208 17.8042 16.55 18 16 18H2ZM4 14H14C14.2 14 14.35 13.9083 14.45 13.725C14.55 13.5417 14.5333 13.3667 14.4 13.2L11.65 9.525C11.55 9.39167 11.4167 9.325 11.25 9.325C11.0833 9.325 10.95 9.39167 10.85 9.525L8.25 13L6.4 10.525C6.3 10.3917 6.16667 10.325 6 10.325C5.83333 10.325 5.7 10.3917 5.6 10.525L3.6 13.2C3.46667 13.3667 3.45 13.5417 3.55 13.725C3.65 13.9083 3.8 14 4 14ZM5.5 7C5.91667 7 6.27083 6.85417 6.5625 6.5625C6.85417 6.27083 7 5.91667 7 5.5C7 5.08333 6.85417 4.72917 6.5625 4.4375C6.27083 4.14583 5.91667 4 5.5 4C5.08333 4 4.72917 4.14583 4.4375 4.4375C4.14583 4.72917 4 5.08333 4 5.5C4 5.91667 4.14583 6.27083 4.4375 6.5625C4.72917 6.85417 5.08333 7 5.5 7Z\"\n      fill=\"currentColor\"\n    />\n  </SvgIcon>\n);\n\nimport { CustomSelect } from \"./CustomSelect\";\nimport { ColorPicker, FIGMA_TEXT_COLORS } from \"./ColorPicker\";\nimport { getAutoTranslations, getHeadingOptions } from \"./i18n\";\n\n/**\n * Available tool definitions\n * Each tool has a unique key, command, icon, label/title, and group\n */\nexport const TOOLBAR_TOOLS = {\n  // Text formatting\n  bold: {\n    command: \"bold\",\n    icon: BoldIcon,\n    title: \"Bold (Ctrl+B)\",\n    group: \"text\",\n  },\n  italic: {\n    command: \"italic\",\n    icon: ItalicIcon,\n    title: \"Italic (Ctrl+I)\",\n    group: \"text\",\n  },\n  underline: {\n    command: \"underline\",\n    icon: UnderlineIcon,\n    title: \"Underline (Ctrl+U)\",\n    group: \"text\",\n  },\n  strikethrough: {\n    command: \"strikeThrough\",\n    icon: FormatStrikethroughIcon,\n    title: \"Strikethrough (Ctrl+S)\",\n    group: \"text\",\n  },\n  link: {\n    command: \"createLink\",\n    icon: LinkIcon,\n    title: \"Insert Link (Ctrl+K)\",\n    group: \"link\",\n  },\n  clearFormat: {\n    command: \"removeFormat\",\n    icon: FormatClear,\n    title: \"Remove Formatting (Ctrl+E)\",\n    group: \"clean\",\n  },\n\n  // Lists\n  bulletList: {\n    command: \"insertUnorderedList\",\n    icon: BulletListIcon,\n    title: \"Bullet List\",\n    group: \"list\",\n  },\n  numberedList: {\n    command: \"insertOrderedList\",\n    icon: OrderedListIcon,\n    title: \"Numbered List\",\n    group: \"list\",\n  },\n\n  // Indentation\n  outdent: {\n    command: \"outdent\",\n    icon: IndentDecreaseIcon,\n    title: \"Decrease Indent\",\n    group: \"indent\",\n  },\n  indent: {\n    command: \"indent\",\n    icon: IndentIncreaseIcon,\n    title: \"Increase Indent\",\n    group: \"indent\",\n  },\n\n  // Alignment\n  alignLeft: {\n    command: \"justifyLeft\",\n    icon: FormatAlignLeft,\n    title: \"Align Left\",\n    group: \"align\",\n  },\n  alignCenter: {\n    command: \"justifyCenter\",\n    icon: FormatAlignCenter,\n    title: \"Align Center\",\n    group: \"align\",\n  },\n  alignRight: {\n    command: \"justifyRight\",\n    icon: FormatAlignRight,\n    title: \"Align Right\",\n    group: \"align\",\n  },\n  alignJustify: {\n    command: \"justifyFull\",\n    icon: FormatAlignJustify,\n    title: \"Justify\",\n    group: \"align\",\n  },\n\n  // Media\n  image: {\n    command: \"insertImage\",\n    icon: ImageIcon,\n    title: \"Insert Image\",\n    group: \"media\",\n    isFileInput: true,\n  },\n\n  // History\n  undo: {\n    command: \"undo\",\n    icon: UndoIcon,\n    title: \"Undo (Ctrl/Cmd+Z)\",\n    group: \"history\",\n  },\n  redo: {\n    command: \"redo\",\n    icon: RedoIcon,\n    title: \"Redo (Ctrl+Y / Cmd+Shift+Z)\",\n    group: \"history\",\n  },\n\n  // Text Color\n  textColor: {\n    command: \"foreColor\",\n    icon: TextColorIcon,\n    title: \"Text Color\",\n    group: \"color\",\n    hasDropdown: true,\n  },\n\n  // Search\n  search: {\n    command: \"search\",\n    icon: SearchIcon,\n    title: \"Search\",\n    group: \"search\",\n  },\n\n  // Help\n  help: {\n    command: \"help\",\n    icon: HelpIcon,\n    title: \"Help\",\n    group: \"help\",\n  },\n};\n\n/**\n * Default text colors for the color picker\n * Uses the Figma design palette (5 rows x 4 columns = 20 colors)\n */\nexport const DEFAULT_TEXT_COLORS = FIGMA_TEXT_COLORS;\n\n/**\n * Default tool groups configuration (left side)\n * Tools are organized in groups separated by dividers\n */\nexport const DEFAULT_TOOL_GROUPS = [\n  [\"heading\"], // Special: heading dropdown\n  [\"bold\", \"italic\", \"underline\", \"strikethrough\"],\n  [\"textColor\"],\n  [\"bulletList\", \"numberedList\"],\n  [\"outdent\", \"indent\"],\n  [\"alignLeft\", \"alignCenter\", \"alignRight\"],\n  [\"image\", \"link\"],\n  [\"undo\", \"redo\"],\n];\n\n/**\n * Default right-side tool groups\n * These appear on the right side of the toolbar\n */\nexport const DEFAULT_RIGHT_TOOL_GROUPS = [\n  [\"search\", \"help\"],\n];\n\n/**\n * Default tooltip titles for all tools (English)\n * Can be overridden via toolTitles prop or translations prop\n */\nexport const DEFAULT_TOOL_TITLES = getAutoTranslations().toolbar;\n\n/**\n * Toolbar component for the rich text editor\n * Provides configurable formatting controls\n *\n * @param {Object} props\n * @param {Function} props.onFormat - Callback for formatting commands\n * @param {Array} props.toolGroups - Array of tool group arrays defining which tools to show\n * @param {Object} props.toolTitles - Custom tooltip titles for tools (overrides defaults)\n * @param {Array} props.headingOptions - Custom heading dropdown options\n * @param {string} props.currentBlockFormat - Current block format (h1-h6, p)\n * @param {Object} props.currentInlineFormats - Current inline format states\n * @param {Function} props.onImageUpload - Custom image upload handler\n * @param {Object} props.translations - Custom translations for i18n support\n * @param {React.ComponentType} props.TooltipComponent - Custom Tooltip component to use instead of MUI Tooltip\n * @param {Array} props.rightToolGroups - Array of tool group arrays for right side of toolbar\n * @param {Function} props.onSearch - Callback when search button is clicked\n * @param {Function} props.onHelp - Callback when help button is clicked\n * @param {Array} props.textColors - Custom color palette for text color picker\n */\nexport const Toolbar = ({\n  onFormat,\n  toolGroups = DEFAULT_TOOL_GROUPS,\n  toolTitles = {},\n  headingOptions,\n  currentBlockFormat = \"p\",\n  currentInlineFormats = {},\n  onImageUpload,\n  translations = {},\n  TooltipComponent,\n  rightToolGroups = DEFAULT_RIGHT_TOOL_GROUPS,\n  onSearch,\n  onHelp,\n  textColors = DEFAULT_TEXT_COLORS,\n  disabled = false,\n}) => {\n  const theme = useTheme();\n  const imageInputRef = useRef(null);\n  const imageSelectionRangeRef = useRef(null);\n  const [colorAnchorEl, setColorAnchorEl] = useState(null);\n  const [currentTextColor, setCurrentTextColor] = useState(\"#536886\");\n  const [colorSelectionRange, setColorSelectionRange] = useState(null);\n\n  // Use custom TooltipComponent or default MUI Tooltip\n  const TooltipWrapper = TooltipComponent || Tooltip;\n\n  // Get base translations (auto-detected or from passed translations)\n  const baseTranslations = getAutoTranslations();\n\n  // Get merged translations for toolbar and headings\n  const mergedToolbarTitles = {\n    ...baseTranslations.toolbar,\n    ...(translations.toolbar || {}),\n    ...toolTitles,\n  };\n\n  // Get heading options from translations or use provided headingOptions\n  const resolvedHeadingOptions = headingOptions || getHeadingOptions(translations);\n\n  /**\n   * Get tooltip title for a tool\n   * Uses custom title if provided, otherwise falls back to default\n   */\n  const getToolTitle = (toolKey) => {\n    // First check custom titles/translations, then default titles, then tool definition\n    return (\n      mergedToolbarTitles[toolKey] ||\n      DEFAULT_TOOL_TITLES[toolKey] ||\n      TOOLBAR_TOOLS[toolKey]?.title ||\n      \"\"\n    );\n  };\n\n  /**\n   * Handle image file selection\n   */\n  const handleImageSelect = (e) => {\n    const file = e.target.files?.[0];\n    if (file && file.type.startsWith(\"image/\")) {\n      // Restore the selection that was saved before the file dialog opened\n      if (imageSelectionRangeRef.current) {\n        const selection = window.getSelection();\n        selection.removeAllRanges();\n        selection.addRange(imageSelectionRangeRef.current);\n        imageSelectionRangeRef.current = null;\n      }\n      if (onImageUpload) {\n        onImageUpload(file);\n      } else {\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          onFormat(\"insertImage\", event.target.result);\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n    e.target.value = \"\";\n  };\n\n  /**\n   * Handle button click\n   */\n  const handleButtonClick = (command, value) => {\n    onFormat(command, value);\n  };\n\n  /**\n   * Check if a tool is active\n   */\n  const isToolActive = (toolKey) => {\n    const tool = TOOLBAR_TOOLS[toolKey];\n    if (!tool) return false;\n\n    // Map command to inline format key\n    const commandToFormatKey = {\n      bold: \"bold\",\n      italic: \"italic\",\n      underline: \"underline\",\n      strikeThrough: \"strikeThrough\",\n      createLink: \"link\",\n      insertUnorderedList: \"unorderedList\",\n      insertOrderedList: \"orderedList\",\n      justifyLeft: \"justifyLeft\",\n      justifyCenter: \"justifyCenter\",\n      justifyRight: \"justifyRight\",\n      justifyFull: \"justifyFull\",\n    };\n\n    const formatKey = commandToFormatKey[tool.command];\n    return formatKey ? currentInlineFormats?.[formatKey] || false : false;\n  };\n\n  /**\n   * Handle color picker open\n   * Stores the current selection range before opening the popover\n   */\n  const handleColorClick = (event) => {\n    // Store the current selection before opening the popover\n    const selection = window.getSelection();\n    if (selection && selection.rangeCount > 0) {\n      setColorSelectionRange(selection.getRangeAt(0).cloneRange());\n    }\n    setColorAnchorEl(event.currentTarget);\n  };\n\n  /**\n   * Handle color picker close\n   */\n  const handleColorClose = () => {\n    setColorAnchorEl(null);\n    setColorSelectionRange(null);\n  };\n\n  /**\n   * Handle color selection\n   * Restores the selection range before applying the color\n   */\n  const handleColorSelect = (color) => {\n    // Restore the selection before applying the color\n    if (colorSelectionRange) {\n      const selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(colorSelectionRange);\n    }\n\n    setCurrentTextColor(color);\n    onFormat(\"foreColor\", color);\n    handleColorClose();\n  };\n\n  /**\n   * Handle search button click\n   */\n  const handleSearchClick = () => {\n    if (onSearch) {\n      onSearch();\n    } else {\n      onFormat(\"search\");\n    }\n  };\n\n  /**\n   * Handle help button click\n   */\n  const handleHelpClick = () => {\n    if (onHelp) {\n      onHelp();\n    } else {\n      onFormat(\"help\");\n    }\n  };\n\n  /**\n   * Render a single tool button\n   */\n  const renderToolButton = (toolKey) => {\n    const tool = TOOLBAR_TOOLS[toolKey];\n    if (!tool) return null;\n\n    const Icon = tool.icon;\n    const active = isToolActive(toolKey);\n    const tooltipTitle = getToolTitle(toolKey);\n\n    // Special handling for image input\n    if (tool.isFileInput) {\n      return (\n        <React.Fragment key={toolKey}>\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            ref={imageInputRef}\n            onChange={handleImageSelect}\n            style={{ display: \"none\" }}\n          />\n          <TooltipWrapper title={tooltipTitle} placement=\"top\">\n            <IconButton\n              onClick={() => imageInputRef.current?.click()}\n              disabled={disabled}\n              size=\"small\"\n              className=\"notranslate\"\n              translate=\"no\"\n              sx={{\n                borderRadius: \"4px\",\n                padding: \"4px\",\n                width: 32,\n                height: 32,\n                color: theme.palette.text.secondary,\n                \"&:hover\": { bgcolor: theme.palette.action.hover },\n                \"&:active\": { bgcolor: theme.palette.action.selected },\n              }}\n            >\n              <Icon sx={{ fontSize: 20 }} />\n            </IconButton>\n          </TooltipWrapper>\n        </React.Fragment>\n      );\n    }\n\n    // Special handling for text color with dropdown\n    if (toolKey === \"textColor\") {\n      const colorOpen = Boolean(colorAnchorEl);\n      return (\n        <React.Fragment key={toolKey}>\n          <TooltipWrapper title={tooltipTitle} placement=\"top\">\n            <Box\n              onClick={disabled ? undefined : handleColorClick}\n              sx={{\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                borderRadius: \"4px\",\n                cursor: disabled ? \"default\" : \"pointer\",\n                opacity: disabled ? 0.38 : 1,\n                pointerEvents: disabled ? \"none\" : \"auto\",\n                \"&:hover\": { bgcolor: disabled ? undefined : theme.palette.action.hover },\n              }}\n            >\n              {/* Icon container with 4px padding */}\n              <Box\n                sx={{\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  overflow: \"hidden\",\n                  p: \"4px\",\n                  borderRadius: \"4px\",\n                }}\n              >\n                <Box\n                  sx={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    width: 24,\n                    height: 24,\n                  }}\n                >\n                  <Icon\n                    sx={{\n                      fontSize: 18,\n                      color: theme.palette.text.secondary,\n                    }}\n                  />\n                  {/* Color indicator bar below the A */}\n                  <Box\n                    sx={{\n                      width: 16,\n                      height: \"3px\",\n                      bgcolor: currentTextColor,\n                      borderRadius: \"1px\",\n                      mt: \"1px\",\n                    }}\n                  />\n                </Box>\n              </Box>\n              {/* Expand arrow with 4px padding */}\n              <Box\n                sx={{\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  p: \"4px\",\n                }}\n              >\n                <ExpandMoreIcon\n                  sx={{\n                    fontSize: 24,\n                    color: \"#A9B1BF\",\n                  }}\n                />\n              </Box>\n            </Box>\n          </TooltipWrapper>\n          <ColorPicker\n            open={colorOpen}\n            anchorEl={colorAnchorEl}\n            onClose={handleColorClose}\n            onColorSelect={handleColorSelect}\n            selectedColor={currentTextColor}\n            colors={textColors}\n          />\n        </React.Fragment>\n      );\n    }\n\n    // Special handling for search\n    if (toolKey === \"search\") {\n      return (\n        <TooltipWrapper key={toolKey} title={tooltipTitle} placement=\"top\">\n          <IconButton\n            onClick={handleSearchClick}\n            disabled={disabled}\n            size=\"small\"\n            className=\"notranslate\"\n            translate=\"no\"\n            sx={{\n              borderRadius: \"4px\",\n              padding: \"4px\",\n              width: 32,\n              height: 32,\n              color: theme.palette.text.secondary,\n              \"&:hover\": { bgcolor: theme.palette.action.hover },\n              \"&:active\": { bgcolor: theme.palette.action.selected },\n            }}\n          >\n            <Icon sx={{ fontSize: 20 }} />\n          </IconButton>\n        </TooltipWrapper>\n      );\n    }\n\n    // Special handling for help\n    if (toolKey === \"help\") {\n      return (\n        <TooltipWrapper key={toolKey} title={tooltipTitle} placement=\"top\">\n          <IconButton\n            onClick={handleHelpClick}\n            disabled={disabled}\n            size=\"small\"\n            className=\"notranslate\"\n            translate=\"no\"\n            sx={{\n              borderRadius: \"4px\",\n              padding: \"4px\",\n              width: 32,\n              height: 32,\n              color: theme.palette.text.secondary,\n              \"&:hover\": { bgcolor: theme.palette.action.hover },\n              \"&:active\": { bgcolor: theme.palette.action.selected },\n            }}\n          >\n            <Icon sx={{ fontSize: 20 }} />\n          </IconButton>\n        </TooltipWrapper>\n      );\n    }\n\n    return (\n      <TooltipWrapper key={toolKey} title={tooltipTitle} placement=\"top\">\n        <IconButton\n          onClick={() => handleButtonClick(tool.command)}\n          disabled={disabled}\n          size=\"small\"\n          className=\"notranslate\"\n          translate=\"no\"\n          sx={{\n            borderRadius: \"4px\",\n            padding: \"4px\",\n            width: 32,\n            height: 32,\n            color: active\n              ? theme.palette.primary.main\n              : theme.palette.text.secondary,\n            bgcolor: active ? \"action.selected\" : undefined,\n            \"&:hover\": { bgcolor: theme.palette.action.hover },\n            \"&:active\": { bgcolor: theme.palette.action.selected },\n          }}\n        >\n          <Icon sx={{ fontSize: 20 }} />\n        </IconButton>\n      </TooltipWrapper>\n    );\n  };\n\n  /**\n   * Render a tool group\n   */\n  const renderToolGroup = (tools, groupIndex) => {\n    // Special handling for heading dropdown\n    if (tools.includes(\"heading\")) {\n      return (\n        <CustomSelect\n          key={`group-${groupIndex}`}\n          value={currentBlockFormat}\n          options={resolvedHeadingOptions}\n          onChange={(event) =>\n            handleButtonClick(\"formatBlock\", event.target.value)\n          }\n          disabled={disabled}\n          sx={{ minWidth: 120 }}\n        />\n      );\n    }\n\n    // Filter out invalid tools\n    const validTools = tools.filter((toolKey) => TOOLBAR_TOOLS[toolKey]);\n    if (validTools.length === 0) return null;\n\n    return (\n      <Box\n        key={`group-${groupIndex}`}\n        sx={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}\n      >\n        {validTools.map((toolKey) => renderToolButton(toolKey))}\n      </Box>\n    );\n  };\n\n  // Filter out empty groups\n  const validGroups = toolGroups.filter((group) => {\n    if (group.includes(\"heading\")) return true;\n    return group.some((toolKey) => TOOLBAR_TOOLS[toolKey]);\n  });\n\n  // Filter out empty right groups and tools without handlers\n  const validRightGroups = rightToolGroups\n    .map((group) => {\n      return group.filter((toolKey) => {\n        // Only show search if onSearch is provided\n        if (toolKey === \"search\" && !onSearch) return false;\n        // Only show help if onHelp is provided\n        if (toolKey === \"help\" && !onHelp) return false;\n        return TOOLBAR_TOOLS[toolKey];\n      });\n    })\n    .filter((group) => group.length > 0);\n\n  return (\n    <Box\n      className=\"notranslate\"\n      translate=\"no\"\n      onMouseDown={(e) => {\n        // Prevent toolbar clicks from stealing focus from the editor\n        e.preventDefault();\n      }}\n      sx={{\n        px: \"8px\",\n        py: \"4px\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"space-between\",\n      }}\n    >\n      {/* Left side tools */}\n      <Box\n        sx={{\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          alignItems: \"center\",\n          gap: \"4px\",\n        }}\n      >\n        {validGroups.map((group, index) => (\n          <React.Fragment key={`fragment-${index}`}>\n            {index > 0 && (\n              <Divider orientation=\"vertical\" flexItem sx={{ height: 32, borderColor: \"#e5e8ec\" }} />\n            )}\n            {renderToolGroup(group, index)}\n          </React.Fragment>\n        ))}\n      </Box>\n\n      {/* Right side tools */}\n      {validRightGroups.length > 0 && (\n        <Box\n          sx={{\n            display: \"flex\",\n            alignItems: \"center\",\n            gap: \"4px\",\n          }}\n        >\n          {validRightGroups.map((group, index) => (\n            <Box\n              key={`right-group-${index}`}\n              sx={{ display: \"flex\", alignItems: \"center\", gap: \"4px\" }}\n            >\n              {group.map((toolKey) => renderToolButton(toolKey))}\n            </Box>\n          ))}\n        </Box>\n      )}\n    </Box>\n  );\n};\n\n// PropTypes for type checking\nToolbar.propTypes = {\n  /** Callback function for formatting commands */\n  onFormat: PropTypes.func.isRequired,\n  /** Array of tool group arrays defining which tools to show */\n  toolGroups: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n  /** Custom tooltip titles for tools (overrides defaults) */\n  toolTitles: PropTypes.objectOf(PropTypes.string),\n  /** Custom heading dropdown options */\n  headingOptions: PropTypes.arrayOf(\n    PropTypes.shape({\n      value: PropTypes.string.isRequired,\n      label: PropTypes.string.isRequired,\n    })\n  ),\n  /** Current block format (h1, h2, h3, h4, h5, h6, p) */\n  currentBlockFormat: PropTypes.string,\n  /** Object containing current inline format states */\n  currentInlineFormats: PropTypes.shape({\n    bold: PropTypes.bool,\n    italic: PropTypes.bool,\n    underline: PropTypes.bool,\n    strikeThrough: PropTypes.bool,\n    link: PropTypes.bool,\n    unorderedList: PropTypes.bool,\n    orderedList: PropTypes.bool,\n    justifyLeft: PropTypes.bool,\n    justifyCenter: PropTypes.bool,\n    justifyRight: PropTypes.bool,\n    justifyFull: PropTypes.bool,\n  }),\n  /** Custom image upload handler - receives File object */\n  onImageUpload: PropTypes.func,\n  /** Custom translations for i18n support */\n  translations: PropTypes.object,\n  /** Custom Tooltip component to use instead of MUI Tooltip */\n  TooltipComponent: PropTypes.elementType,\n  /** Array of tool group arrays for right side of toolbar */\n  rightToolGroups: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n  /** Callback when search button is clicked */\n  onSearch: PropTypes.func,\n  /** Callback when help button is clicked */\n  onHelp: PropTypes.func,\n  /** Custom color palette for text color picker */\n  textColors: PropTypes.arrayOf(PropTypes.string),\n  /** Whether the toolbar is disabled (editor not focused) */\n  disabled: PropTypes.bool,\n};\n\n// Default props\nToolbar.defaultProps = {\n  toolGroups: DEFAULT_TOOL_GROUPS,\n  toolTitles: {},\n  headingOptions: undefined,\n  currentBlockFormat: \"p\",\n  currentInlineFormats: {},\n  onImageUpload: undefined,\n  translations: {},\n  TooltipComponent: undefined,\n  rightToolGroups: DEFAULT_RIGHT_TOOL_GROUPS,\n  onSearch: undefined,\n  onHelp: undefined,\n  textColors: DEFAULT_TEXT_COLORS,\n  disabled: false,\n};\n","import React, { useCallback, useRef, useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Box, Divider } from \"@mui/material\";\nimport { styled, useTheme } from \"@mui/material/styles\";\nimport {\n  applyFormatting,\n  insertLink,\n  countContentRealLength,\n  getCurrentBlockFormat,\n  insertImage,\n  cleanupEditorHTML,\n} from \"./utils/editorsUtils\";\nimport { LinkTooltip } from \"./LinkTooltip\";\nimport {\n  Toolbar,\n  DEFAULT_TOOL_GROUPS,\n  DEFAULT_RIGHT_TOOL_GROUPS,\n  DEFAULT_TEXT_COLORS,\n} from \"./Toolbar\";\nimport { getAutoTranslations, getTranslations } from \"./i18n\";\n\n/**\n * Design tokens from Figma\n */\nconst designTokens = {\n  colors: {\n    borderPrimary: \"#0b89d1\",\n    textDefault: \"#536886\",\n    textPrimary: \"#0b89d1\",\n    surfaceBase: \"#ffffff\",\n  },\n  spacing: {\n    spacing1: \"8px\",\n    spacing1_5: \"12px\",\n  },\n  borderRadius: \"4px\",\n  typography: {\n    inputText: {\n      fontFamily: \"'Roboto', sans-serif\",\n      fontSize: \"14px\",\n      fontWeight: 400,\n      lineHeight: \"24px\",\n    },\n    inputLabel: {\n      fontFamily: \"'Roboto', sans-serif\",\n      fontSize: \"12px\",\n      fontWeight: 400,\n      lineHeight: \"16px\",\n    },\n  },\n};\n\n/**\n * Styled editor component with rich text formatting styles\n */\nconst StyledEditor = styled(Box)(({ theme }) => ({\n  padding: `${designTokens.spacing.spacing1} ${designTokens.spacing.spacing1_5}`,\n  paddingTop: theme.spacing(0),\n  outline: \"none\",\n  fontFamily: designTokens.typography.inputText.fontFamily,\n  fontSize: designTokens.typography.inputText.fontSize,\n  fontWeight: designTokens.typography.inputText.fontWeight,\n  lineHeight: designTokens.typography.inputText.lineHeight,\n  color: theme.palette.text.primary,\n  \"& p\": {\n    margin: `${theme.spacing(1)}px 0`,\n    \"&:first-of-type\": { marginTop: 0 },\n    \"&:last-of-type\": { marginBottom: 0 },\n  },\n  \"& h1\": {\n    fontSize: \"2rem\",\n    fontWeight: \"bold\",\n    margin: `${theme.spacing(1.5)}px 0`,\n  },\n  \"& h2\": {\n    fontSize: \"1.5rem\",\n    fontWeight: \"bold\",\n    margin: `${theme.spacing(1)}px 0`,\n  },\n  \"& h3\": {\n    fontSize: \"1.25rem\",\n    fontWeight: \"bold\",\n    margin: `${theme.spacing(1)}px 0`,\n  },\n  \"& ul\": {\n    listStyle: \"disc\",\n    paddingLeft: theme.spacing(3),\n    margin: `${theme.spacing(1)}px 0`,\n  },\n  \"& ol\": {\n    listStyle: \"decimal\",\n    paddingLeft: theme.spacing(3),\n    margin: `${theme.spacing(1)}px 0`,\n  },\n  \"& li\": {\n    margin: `${theme.spacing(0.5)}px 0`,\n  },\n  \"& blockquote\": {\n    borderLeft: `4px solid ${theme.palette.primary.main}`,\n    paddingLeft: theme.spacing(2),\n    fontStyle: \"italic\",\n    margin: `${theme.spacing(2)}px 0`,\n    color: theme.palette.text.secondary,\n  },\n  \"& a\": {\n    color: theme.palette.primary.main,\n    textDecoration: \"underline\",\n    \"&:hover\": {\n      opacity: 0.8,\n    },\n  },\n  \"& strong\": { fontWeight: \"bold\" },\n  \"& em\": { fontStyle: \"italic\" },\n  \"& u\": { textDecoration: \"underline\" },\n  \"& img\": {\n    maxWidth: \"100%\",\n    height: \"auto\",\n    display: \"block\",\n    margin: \"8px 0\",\n    borderRadius: \"4px\",\n  },\n}));\n\n/**\n * RichTextEditor component\n * A full-featured rich text editor with toolbar and link management\n */\nexport const RichTextEditor = ({\n  name = \"\",\n  value = \"\",\n  onChange = () => {},\n  onBlur,\n  placeholder,\n  maxChars = null,\n  height = \"auto\",\n  minHeight = \"150px\",\n  maxHeight = null,\n  sx = {},\n  style,\n  toolGroups = DEFAULT_TOOL_GROUPS,\n  toolTitles = {},\n  headingOptions,\n  onImageUpload,\n  locale,\n  translations = {},\n  TooltipComponent,\n  rightToolGroups = DEFAULT_RIGHT_TOOL_GROUPS,\n  onSearch,\n  onHelp,\n  textColors = DEFAULT_TEXT_COLORS,\n}) => {\n  // Get MUI theme from parent\n  const theme = useTheme();\n  const isDarkMode = theme.palette.mode === \"dark\";\n\n  // Get base translations - either from specified locale or auto-detected\n  const baseTranslations = locale\n    ? getTranslations(locale)\n    : getAutoTranslations();\n\n  // Merge custom translations with base translations\n  const mergedTranslations = {\n    ...baseTranslations,\n    ...translations,\n    toolbar: { ...baseTranslations.toolbar, ...(translations.toolbar || {}) },\n    headings: {\n      ...baseTranslations.headings,\n      ...(translations.headings || {}),\n    },\n    linkTooltip: {\n      ...baseTranslations.linkTooltip,\n      ...(translations.linkTooltip || {}),\n    },\n    editor: { ...baseTranslations.editor, ...(translations.editor || {}) },\n  };\n\n  // Get placeholder from prop or translations\n  const resolvedPlaceholder =\n    placeholder || mergedTranslations.editor.placeholder;\n\n  // Refs for DOM elements\n  const editorRef = useRef(null);\n  const tooltipRef = useRef(null);\n  const containerRef = useRef(null);\n\n  // State management\n  const [showLinkTooltip, setShowLinkTooltip] = useState(false);\n  const [linkTooltipPosition, setLinkTooltipPosition] = useState({\n    x: 0,\n    y: 0,\n  });\n  const [currentLink, setCurrentLink] = useState(\"\");\n  const [charLeft, setCharLeft] = useState(\n    maxChars ? countContentRealLength(value) : null,\n  );\n  const [isLinkEdit, setIsLinkEdit] = useState(false);\n  const [storedRange, setStoredRange] = useState(null);\n  const [isFocused, setIsFocused] = useState(false);\n  const [currentBlockFormat, setCurrentBlockFormat] = useState(\"p\");\n  const [isEmpty, setIsEmpty] = useState(() => {\n    return !value || value === \"<br>\" || value === \"<p><br></p>\";\n  });\n\n  // Current inline format states\n  const [currentInlineFormats, setCurrentInlineFormats] = useState({\n    bold: false,\n    italic: false,\n    underline: false,\n    strikeThrough: false,\n    link: false,\n    unorderedList: false,\n    orderedList: false,\n    justifyLeft: false,\n    justifyCenter: false,\n    justifyRight: false,\n    justifyFull: false,\n  });\n\n  // Update editor content when value prop changes\n  useEffect(() => {\n    if (editorRef.current && value !== editorRef.current.innerHTML) {\n      editorRef.current.innerHTML = value;\n    }\n    // Update isEmpty state when value prop changes\n    const contentEmpty = !value || value === \"<br>\" || value === \"<p><br></p>\";\n    setIsEmpty(contentEmpty);\n  }, [value]);\n\n  /**\n   * Update current block format\n   */\n  const updateCurrentBlockFormat = useCallback(() => {\n    if (editorRef.current) {\n      setCurrentBlockFormat(getCurrentBlockFormat());\n    }\n  }, []);\n\n  // Initialize block format on mount\n  useEffect(() => {\n    updateCurrentBlockFormat();\n  }, [updateCurrentBlockFormat]);\n\n  /**\n   * Handle input changes in the editor\n   */\n  const handleInput = useCallback(() => {\n    if (editorRef.current && onChange) {\n      const html = editorRef.current.innerHTML;\n      if (maxChars) {\n        const charLeftLength = countContentRealLength(html);\n        setCharLeft(charLeftLength);\n      }\n      // Update isEmpty state\n      const contentEmpty = !html || html === \"<br>\" || html === \"<p><br></p>\";\n      setIsEmpty(contentEmpty);\n      onChange({ target: { name, value: html } });\n      updateCurrentBlockFormat();\n      updateCurrentInlineFormats();\n    }\n  }, [\n    onChange,\n    name,\n    maxChars,\n    updateCurrentBlockFormat,\n    updateCurrentInlineFormats,\n  ]);\n\n  /**\n   * Handle formatting commands from toolbar\n   * @param {string} command - The formatting command\n   * @param {string} value - Optional value for the command\n   */\n  const handleFormat = useCallback(\n    (command, value) => {\n      if (command === \"createLink\") {\n        const selection = window.getSelection();\n        if (selection && !selection.isCollapsed) {\n          const range = selection.getRangeAt(0).cloneRange();\n          setStoredRange(range);\n          const rect = range.getBoundingClientRect();\n          const editorRect = editorRef.current?.getBoundingClientRect();\n          if (editorRect) {\n            setLinkTooltipPosition({\n              x: rect.left - editorRect.left + rect.width / 2,\n              y: rect.bottom - editorRect.top + 5,\n            });\n            setCurrentLink(\"\");\n            setIsLinkEdit(false);\n            setShowLinkTooltip(true);\n          }\n        } else {\n          const range = selection?.getRangeAt(0);\n          if (range) {\n            setStoredRange(range.cloneRange());\n            const rect = range.getBoundingClientRect();\n            const editorRect = editorRef.current?.getBoundingClientRect();\n            if (editorRect) {\n              setLinkTooltipPosition({\n                x: rect.left - editorRect.left,\n                y: rect.bottom - editorRect.top + 5,\n              });\n              setCurrentLink(\"\");\n              setIsLinkEdit(false);\n              setShowLinkTooltip(true);\n            }\n          }\n        }\n        return;\n      }\n\n      if (command === \"removeFormat\") {\n        document.execCommand(\"removeFormat\", false, null);\n        handleInput();\n        return;\n      }\n\n      if (command === \"insertImage\") {\n        insertImage(value);\n        handleInput();\n        return;\n      }\n\n      applyFormatting(command, value);\n\n      // Clean up malformed HTML after block format changes\n      if (command === \"formatBlock\") {\n        cleanupEditorHTML(editorRef.current);\n      }\n\n      editorRef.current?.focus();\n      handleInput();\n      updateCurrentBlockFormat();\n      updateCurrentInlineFormats();\n    },\n    [handleInput, updateCurrentInlineFormats, updateCurrentBlockFormat],\n  );\n\n  /**\n   * Handle link submission from tooltip\n   * @param {string} url - The URL to insert\n   */\n  const handleLinkSubmit = useCallback(\n    (url) => {\n      insertLink(url, storedRange || undefined);\n      setShowLinkTooltip(false);\n      setStoredRange(null);\n      handleInput();\n    },\n    [handleInput, storedRange],\n  );\n\n  /**\n   * Handle clicks on links for editing\n   * @param {MouseEvent} e - Click event\n   */\n  const handleClick = useCallback((e) => {\n    const target = e.target;\n    if (target.tagName === \"A\") {\n      e.preventDefault();\n      const range = document.createRange();\n      range.selectNode(target);\n      setStoredRange(range);\n      const rect = target.getBoundingClientRect();\n      const editorRect = editorRef.current?.getBoundingClientRect();\n      if (editorRect) {\n        setLinkTooltipPosition({\n          x: rect.left - editorRect.left + rect.width / 2,\n          y: rect.bottom - editorRect.top + 5,\n        });\n        setCurrentLink(target.getAttribute(\"href\") || \"\");\n        setIsLinkEdit(true);\n        setShowLinkTooltip(true);\n      }\n    } else {\n      setShowLinkTooltip(false);\n    }\n  }, []);\n\n  /**\n   * Handle keyboard shortcuts\n   * @param {KeyboardEvent} e - Keyboard event\n   */\n  const handleKeyDown = useCallback(\n    (e) => {\n      if (e.ctrlKey || e.metaKey) {\n        switch (e.key) {\n          case \"b\":\n            e.preventDefault();\n            handleFormat(\"bold\");\n            break;\n          case \"i\":\n            e.preventDefault();\n            handleFormat(\"italic\");\n            break;\n          case \"u\":\n            e.preventDefault();\n            handleFormat(\"underline\");\n            break;\n          case \"k\":\n            e.preventDefault();\n            handleFormat(\"createLink\");\n            break;\n          case \"s\":\n            e.preventDefault();\n            handleFormat(\"strikeThrough\");\n            break;\n          case \"e\":\n            e.preventDefault();\n            handleFormat(\"removeFormat\");\n            break;\n          case \"z\":\n            e.preventDefault();\n            // Cmd+Shift+Z or Ctrl+Shift+Z = Redo, Cmd+Z or Ctrl+Z = Undo\n            if (e.shiftKey) {\n              handleFormat(\"redo\");\n            } else {\n              handleFormat(\"undo\");\n            }\n            break;\n          case \"y\":\n            // Ctrl+Y = Redo (Windows/Linux)\n            e.preventDefault();\n            handleFormat(\"redo\");\n            break;\n          case \"]\":\n            e.preventDefault();\n            handleFormat(\"indent\");\n            break;\n          case \"[\":\n            e.preventDefault();\n            handleFormat(\"outdent\");\n            break;\n        }\n      }\n\n      if (e.key === \"Escape\") {\n        setShowLinkTooltip(false);\n        setStoredRange(null);\n      }\n    },\n    [handleFormat],\n  );\n\n  /**\n   * Update current inline format states\n   */\n  const updateCurrentInlineFormats = useCallback(() => {\n    updateCurrentBlockFormat();\n    const selection = document.getSelection();\n    if (!selection || !editorRef.current) return;\n    if (!editorRef.current.contains(selection.anchorNode)) return;\n\n    setCurrentInlineFormats({\n      bold: document.queryCommandState(\"bold\"),\n      italic: document.queryCommandState(\"italic\"),\n      underline: document.queryCommandState(\"underline\"),\n      strikeThrough: document.queryCommandState(\"strikeThrough\"),\n      link: document.queryCommandState(\"createLink\"),\n      unorderedList: document.queryCommandState(\"insertUnorderedList\"),\n      orderedList: document.queryCommandState(\"insertOrderedList\"),\n      justifyLeft: document.queryCommandState(\"justifyLeft\"),\n      justifyCenter: document.queryCommandState(\"justifyCenter\"),\n      justifyRight: document.queryCommandState(\"justifyRight\"),\n      justifyFull: document.queryCommandState(\"justifyFull\"),\n    });\n  }, [updateCurrentBlockFormat]);\n\n  // Add event listeners for selection changes\n  // Note: selectionchange is a document-level event, not element-level\n  useEffect(() => {\n    const updateFormats = () => {\n      updateCurrentBlockFormat();\n      updateCurrentInlineFormats();\n    };\n\n    document.addEventListener(\"selectionchange\", updateFormats);\n\n    return () => {\n      document.removeEventListener(\"selectionchange\", updateFormats);\n    };\n  }, [updateCurrentBlockFormat, updateCurrentInlineFormats]);\n\n  return (\n    <Box\n      ref={containerRef}\n      tabIndex={-1}\n      sx={{\n        border: `1px solid ${maxChars && charLeft > maxChars ? theme.palette.error.main : theme.palette.primary.main}`,\n        borderRadius: designTokens.borderRadius,\n        \"&:focus-within\": {\n          borderColor:\n            maxChars && charLeft > maxChars\n              ? theme.palette.error.main\n              : theme.palette.primary.main,\n        },\n        color: theme.palette.text.primary,\n        backgroundColor: theme.palette.background.paper,\n        fontFamily: designTokens.typography.inputText.fontFamily,\n        ...sx,\n      }}\n      style={style}\n      onBlur={() => {\n        const active = document.activeElement;\n        if (containerRef.current?.contains(active)) return;\n        setIsFocused(false);\n        if (typeof onBlur === \"function\") {\n          onBlur({ target: { value: editorRef.current?.innerHTML } });\n        }\n      }}\n    >\n      {/* Toolbar */}\n      <Toolbar\n        onFormat={handleFormat}\n        toolGroups={toolGroups}\n        toolTitles={toolTitles}\n        headingOptions={headingOptions}\n        currentBlockFormat={currentBlockFormat}\n        currentInlineFormats={currentInlineFormats}\n        onImageUpload={onImageUpload}\n        translations={mergedTranslations}\n        TooltipComponent={TooltipComponent}\n        rightToolGroups={rightToolGroups}\n        onSearch={onSearch}\n        onHelp={onHelp}\n        textColors={textColors}\n        disabled={!isFocused}\n      />\n      {/* Divider between toolbar and editor */}\n      <Divider sx={{ borderColor: theme.palette.divider }} />\n      {/* Editor content area */}\n      <Box style={{ position: \"relative\" }}>\n        <StyledEditor\n          ref={editorRef}\n          contentEditable\n          className=\"notranslate\"\n          translate=\"no\"\n          onFocus={() => setIsFocused(true)}\n          onInput={handleInput}\n          onClick={handleClick}\n          onKeyDown={handleKeyDown}\n          sx={{\n            minHeight,\n            height,\n            maxHeight,\n            overflowY: maxHeight ? \"auto\" : undefined,\n          }}\n          suppressContentEditableWarning\n        />\n\n        {/* Placeholder text */}\n        {isEmpty && !isFocused && (\n          <Box\n            sx={{\n              position: \"absolute\",\n              top: designTokens.spacing.spacing1,\n              left: designTokens.spacing.spacing1_5,\n              color: theme.palette.text.secondary,\n              pointerEvents: \"none\",\n              userSelect: \"none\",\n              fontFamily: designTokens.typography.inputText.fontFamily,\n              fontSize: designTokens.typography.inputText.fontSize,\n              lineHeight: designTokens.typography.inputText.lineHeight,\n            }}\n          >\n            {resolvedPlaceholder}\n          </Box>\n        )}\n\n        {/* Link tooltip */}\n        {showLinkTooltip && (\n          <LinkTooltip\n            position={linkTooltipPosition}\n            onSubmit={handleLinkSubmit}\n            onClose={() => {\n              setShowLinkTooltip(false);\n              setStoredRange(null);\n            }}\n            initialValue={currentLink}\n            isEdit={isLinkEdit}\n            tooltipRef={tooltipRef}\n            storedRange={storedRange}\n            translations={mergedTranslations.linkTooltip}\n          />\n        )}\n\n        {/* Character counter - styled as floating label */}\n        {maxChars && (\n          <Box\n            sx={{\n              position: \"absolute\",\n              bottom: \"-1px\",\n              right: \"11px\",\n              height: \"2px\",\n              display: \"flex\",\n              alignItems: \"center\",\n              padding: \"0 4px\",\n              background: theme.palette.background.paper,\n            }}\n          >\n            <Box\n              sx={{\n                color:\n                  charLeft > maxChars\n                    ? theme.palette.error.main\n                    : theme.palette.primary.main,\n                fontFamily: designTokens.typography.inputLabel.fontFamily,\n                fontSize: designTokens.typography.inputLabel.fontSize,\n                fontWeight: designTokens.typography.inputLabel.fontWeight,\n                lineHeight: designTokens.typography.inputLabel.lineHeight,\n                whiteSpace: \"nowrap\",\n              }}\n            >\n              {`${charLeft}/${maxChars}`}\n            </Box>\n          </Box>\n        )}\n      </Box>\n    </Box>\n  );\n};\n\n// PropTypes for type checking\nRichTextEditor.propTypes = {\n  /** Name attribute for the editor */\n  name: PropTypes.string,\n  /** Current value of the editor */\n  value: PropTypes.string,\n  /** Callback function when content changes */\n  onChange: PropTypes.func,\n  /** Callback function when editor loses focus */\n  onBlur: PropTypes.func,\n  /** Placeholder text when editor is empty */\n  placeholder: PropTypes.string,\n  /** Maximum number of characters allowed */\n  maxChars: PropTypes.number,\n  /** Height of the editor */\n  height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  /** Minimum height of the editor */\n  minHeight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  /** Maximum height of the editor */\n  maxHeight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  /** Additional styles for the container */\n  sx: PropTypes.object,\n  /** Additional inline styles */\n  style: PropTypes.object,\n  /** Array of tool group arrays defining which toolbar tools to show */\n  toolGroups: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n  /** Custom tooltip titles for toolbar tools */\n  toolTitles: PropTypes.objectOf(PropTypes.string),\n  /** Custom heading dropdown options */\n  headingOptions: PropTypes.arrayOf(\n    PropTypes.shape({\n      value: PropTypes.string.isRequired,\n      label: PropTypes.string.isRequired,\n    }),\n  ),\n  /** Custom image upload handler - receives File object */\n  onImageUpload: PropTypes.func,\n  /** Locale code for translations (e.g., \"en\", \"de\"). Auto-detected if not provided. */\n  locale: PropTypes.string,\n  /** Custom translations to override defaults */\n  translations: PropTypes.shape({\n    toolbar: PropTypes.object,\n    headings: PropTypes.object,\n    linkTooltip: PropTypes.object,\n    editor: PropTypes.object,\n  }),\n  /** Custom Tooltip component to use instead of MUI Tooltip */\n  TooltipComponent: PropTypes.elementType,\n  /** Array of tool group arrays for right side of toolbar */\n  rightToolGroups: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n  /** Callback when search button is clicked */\n  onSearch: PropTypes.func,\n  /** Callback when help button is clicked */\n  onHelp: PropTypes.func,\n  /** Custom color palette for text color picker */\n  textColors: PropTypes.arrayOf(PropTypes.string),\n};\n\n// Default props\nRichTextEditor.defaultProps = {\n  name: \"\",\n  value: \"\",\n  onChange: () => {},\n  onBlur: undefined,\n  placeholder: undefined,\n  maxChars: null,\n  height: \"auto\",\n  minHeight: \"150px\",\n  maxHeight: null,\n  sx: {},\n  style: undefined,\n  toolGroups: DEFAULT_TOOL_GROUPS,\n  toolTitles: {},\n  headingOptions: undefined,\n  onImageUpload: undefined,\n  locale: undefined,\n  translations: {},\n  TooltipComponent: undefined,\n  rightToolGroups: DEFAULT_RIGHT_TOOL_GROUPS,\n  onSearch: undefined,\n  onHelp: undefined,\n  textColors: DEFAULT_TEXT_COLORS,\n};\n"],"names":["applyFormatting","command","value","arguments","length","undefined","applyBlockFormatInList","cleanupInlineFontStyles","document","execCommand","format","selection","window","getSelection","rangeCount","node","anchorNode","nodeType","Node","TEXT_NODE","parentElement","listItem","current","tagName","contentEditable","tag","replace","toLowerCase","querySelectorAll","forEach","heading","firstChild","parentNode","insertBefore","remove","includes","createElement","appendChild","container","getRangeAt","commonAncestorContainer","_blockElement$getAttr","blockElement","el","_el$getAttribute","style","removeProperty","getAttribute","trim","removeAttribute","cleanupEditorHTML","editorElement","Array","from","childNodes","some","child","textContent","ELEMENT_NODE","list","nextSibling","insertLink","url","range","removeAllRanges","addRange","isCollapsed","linkElement","href","target","rel","insertNode","setStartAfter","setEndAfter","link","getCurrentBlockFormat","sel","_node$tagName","toUpperCase","insertImage","src","options","_options$alt","alt","_options$width","width","_options$maxWidth","maxWidth","img","height","deleteContents","countContentRealLength","rawText","enUS","toolbar","undo","redo","bold","italic","underline","strikethrough","clearFormat","bulletList","numberedList","outdent","indent","alignLeft","alignCenter","alignRight","alignJustify","image","textColor","search","help","headings","h1","h2","h3","h4","h5","h6","p","linkTooltip","insertTitle","editTitle","placeholder","insert","update","cancel","editor","select","deDE","locales","en","de","supportedLanguages","defaultLanguage","defaultTranslations","normalizeLocale","lang","primaryLang","split","find","locale","detectLanguage","htmlLang","documentElement","normalized","navigator","language","getTranslations","normalizedLocale","getAutoTranslations","detectedLang","deepMerge","source","result","_objectSpread","key","_typeof","isArray","getHeadingOptions","translations","langOrTranslations","autoTranslations","label","fontSize","fontWeight","LinkTooltip","_ref","position","onSubmit","onClose","_ref$initialValue","initialValue","_ref$isEdit","isEdit","tooltipRef","storedRange","_ref$translations","t","baseTranslations","_useState2","_slicedToArray","useState","setUrl","inputRef","useRef","useEffect","setTimeout","focus","React","Paper","elevation","ref","sx","left","x","top","y","transform","zIndex","minWidth","borderRadius","boxShadow","display","flexDirection","gap","Box","alignItems","justifyContent","Typography","fontFamily","lineHeight","color","flex","IconButton","onClick","backgroundColor","CloseIcon","TextField","fullWidth","onChange","e","onKeyDown","variant","borderColor","padding","Button","type","letterSpacing","textTransform","preventDefault","formattedUrl","match","disabled","propTypes","PropTypes","shape","number","isRequired","func","string","bool","oneOfType","any","object","defaultProps","tokens","spacing0_5","spacing1","small","inputText","SelectContainer","styled","SelectInput","paddingLeft","paddingRight","cursor","DataContainer","ContentContainer","overflow","concat","ValueText","theme","palette","text","secondary","whiteSpace","textOverflow","ButtonContainer","IconWrapper","_ref2","open","transition","CustomSelect","_ref3","_ref3$options","_ref3$placeholder","_ref3$disabled","_ref3$sx","useTheme","setOpen","anchorRef","selectedOption","opt","displayValue","handleClick","handleClose","className","translate","tabIndex","role","opacity","pointerEvents","ExpandMoreIcon","Popover","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","slotProps","paper","mt","background","py","map","option","MenuItem","optionValue","selected","minHeight","pl","pr","action","hover","arrayOf","CheckIcon","props","SvgIcon","_extends","viewBox","d","fill","FIGMA_TEXT_COLORS","ColorPicker","onColorSelect","selectedColor","_ref$colors","colors","bgcolor","Math","ceil","_","rowIndex","slice","hex","isSelected","isLight","parseInt","substr","handleColorClick","border","instanceOf","Element","TOOLBAR_TOOLS","icon","title","group","FormatClear","FormatAlignLeft","FormatAlignCenter","FormatAlignRight","FormatAlignJustify","isFileInput","hasDropdown","SearchIcon","Search","HelpIcon","HelpOutline","DEFAULT_TEXT_COLORS","DEFAULT_TOOL_GROUPS","DEFAULT_RIGHT_TOOL_GROUPS","DEFAULT_TOOL_TITLES","Toolbar","onFormat","_ref$toolGroups","toolGroups","_ref$toolTitles","toolTitles","headingOptions","_ref$currentBlockForm","currentBlockFormat","_ref$currentInlineFor","currentInlineFormats","onImageUpload","TooltipComponent","_ref$rightToolGroups","rightToolGroups","onSearch","onHelp","_ref$textColors","textColors","_ref$disabled","imageInputRef","imageSelectionRangeRef","colorAnchorEl","setColorAnchorEl","_useState4","currentTextColor","setCurrentTextColor","_useState6","colorSelectionRange","setColorSelectionRange","TooltipWrapper","Tooltip","mergedToolbarTitles","resolvedHeadingOptions","handleImageSelect","_e$target$files","file","files","startsWith","reader","FileReader","onload","event","readAsDataURL","handleButtonClick","cloneRange","currentTarget","handleColorClose","handleColorSelect","handleSearchClick","handleHelpClick","renderToolButton","toolKey","tool","Icon","active","formatKey","strikeThrough","createLink","insertUnorderedList","insertOrderedList","justifyLeft","justifyCenter","justifyRight","justifyFull","isToolActive","tooltipTitle","_TOOLBAR_TOOLS$toolKe","getToolTitle","Fragment","accept","placement","_imageInputRef$curren","click","size","colorOpen","Boolean","primary","main","validGroups","filter","validRightGroups","onMouseDown","px","flexWrap","index","Divider","orientation","flexItem","tools","groupIndex","validTools","renderToolGroup","objectOf","unorderedList","orderedList","elementType","designTokens","spacing1_5","inputLabel","StyledEditor","paddingTop","spacing","outline","margin","marginTop","marginBottom","listStyle","borderLeft","fontStyle","textDecoration","RichTextEditor","_ref2$name","name","_ref2$value","_ref2$onChange","onBlur","_ref2$maxChars","maxChars","_ref2$height","_ref2$minHeight","_ref2$maxHeight","maxHeight","_ref2$sx","_ref2$toolGroups","_ref2$toolTitles","_ref2$translations","_ref2$rightToolGroups","_ref2$textColors","mode","mergedTranslations","resolvedPlaceholder","editorRef","containerRef","showLinkTooltip","setShowLinkTooltip","linkTooltipPosition","setLinkTooltipPosition","currentLink","setCurrentLink","_useState8","charLeft","setCharLeft","_useState0","isLinkEdit","setIsLinkEdit","_useState10","setStoredRange","_useState12","isFocused","setIsFocused","_useState14","setCurrentBlockFormat","_useState16","isEmpty","setIsEmpty","_useState18","setCurrentInlineFormats","innerHTML","updateCurrentBlockFormat","useCallback","handleInput","html","charLeftLength","updateCurrentInlineFormats","handleFormat","_editorRef$current3","_editorRef$current","rect","getBoundingClientRect","editorRect","bottom","_editorRef$current2","handleLinkSubmit","_editorRef$current4","createRange","selectNode","handleKeyDown","ctrlKey","metaKey","shiftKey","contains","queryCommandState","updateFormats","addEventListener","removeEventListener","error","_containerRef$current","_editorRef$current5","activeElement","divider","onFocus","onInput","overflowY","suppressContentEditableWarning","userSelect","right","div","keyPath","_step","fallback","keys","_iterator","_createForOfIteratorHelper","s","n","done","err","f","toString","fragment","createDocumentFragment","collapse"],"mappings":"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"}